{
    "type": [
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        3,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2
    ],
    "data": [
        "  mutate(military_spending_pct_of_gdp = replace_na(military_spending_pct_of_gdp, 0)) %>% ",
        "+ ",
        "  mutate(murder_per_mil_people = replace(murder_per_mil_people, country == \"Mexico\", 29.07),",
        "+ ",
        "         # https://en.wikipedia.org/wiki/List_of_countries_by_intentional_homicide_rate",
        "+ ",
        "         # these murder rates were not included in the gapminder but i didnt want to ",
        "+ ",
        "         # lose 3 important countries in LA",
        "+ ",
        "         murder_per_mil_people = replace(murder_per_mil_people, country == \"Chile\", 4.4),",
        "+ ",
        "         murder_per_mil_people = replace(murder_per_mil_people, country == \"Colombia\", 25.34)) %>% ",
        "+ ",
        "  relocate(polrights_fh) %>% mutate(polrights_fh = (8 - polrights_fh),",
        "+ ",
        "                                    military_spending_pct_of_gdp = military_spending_pct_of_gdp * 100)",
        "> ",
        "write_csv(data, here::here(\"data\", \"df.csv\"))",
        "> ",
        "data <- readr::read_csv(here::here(\"data\", \"df.csv\"))",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m──────────────────────────────────────────────────────────────────\u001B[39m\ncols(\n  polrights_fh = \u001B[32mcol_double()\u001B[39m,\n  country = \u001B[31mcol_character()\u001B[39m,\n  year = \u001B[32mcol_double()\u001B[39m,\n  corruption_perception_index_cpi = \u001B[32mcol_double()\u001B[39m,\n  edu_exp_gdp_per_person = \u001B[32mcol_double()\u001B[39m,\n  electricity_use_per_person = \u001B[32mcol_double()\u001B[39m,\n  gini = \u001B[32mcol_double()\u001B[39m,\n  internet_users = \u001B[32mcol_double()\u001B[39m,\n  labour_force_participation_rate_percent = \u001B[32mcol_double()\u001B[39m,\n  life_expectancy_years = \u001B[32mcol_double()\u001B[39m,\n  military_spending_pct_of_gdp = \u001B[32mcol_double()\u001B[39m,\n  murder_per_mil_people = \u001B[32mcol_double()\u001B[39m\n)\n\n",
        "> ",
        "View(data)",
        "> ",
        "summary(step(object = fit, direction = \"backward\"))",
        "Start:  AIC=-814.41\npolrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + \n    life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\n\n                                  Df Sum of Sq    RSS     AIC\n<none>                                         181.01 -814.41\n- life_expectancy_years            1     1.742 182.75 -810.21\n- edu_exp_gdp_per_person           1     3.575 184.59 -803.74\n- military_spending_pct_of_gdp     1    18.282 199.29 -754.07\n- murder_per_mil_people          ",
        "  1    18.846 199.86 -752.23\n- corruption_perception_index_cpi  1    56.022 237.03 -641.69\n\nCall:\nlm(formula = polrights_fh ~ corruption_perception_index_cpi + \n    edu_exp_gdp_per_person + life_expectancy_years + military_spending_pct_of_gdp + \n    murder_per_mil_people, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.8381 -0.2132  0.0264  0.3555  1.0201 \n\nCoefficients:\n                                  Estimate Std. Error t value\n(Intercept)                       6.645643   0.657128  10.113",
        "\ncorruption_perception_index_cpi   0.023329   0.001655  14.096\nedu_exp_gdp_per_person            1.900341   0.533705   3.561\nlife_expectancy_years            -0.020873   0.008397  -2.486\nmilitary_spending_pct_of_gdp    -14.987118   1.861213  -8.052\nmurder_per_mil_people            -0.034992   0.004280  -8.176\n                                Pr(>|t|)    \n(Intercept)                      < 2e-16 ***\ncorruption_perception_index_cpi  < 2e-16 ***\nedu_exp_gdp_per_person          0.000397 ***\nlife_expectancy_years          ",
        " 0.013177 *  \nmilitary_spending_pct_of_gdp    3.95e-15 ***\nmurder_per_mil_people           1.57e-15 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.531 on 642 degrees of freedom\nMultiple R-squared:  0.5471,\tAdjusted R-squared:  0.5436 \nF-statistic: 155.1 on 5 and 642 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "subsets",
        "\u001B[38;5;246m# A tibble: 511 x 13\u001B[39m\n   model r.squared adj.r.squared sigma statistic  p.value    df\n   \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m         \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m    \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m\n\u001B[38;5;250m 1\u001B[39m polr…    0.428         0.427  0.595     483.  2.67\u001B[38;5;246me\u001B[39m\u001B[31m-80\u001B[39m     1\n\u001B[38;5;250m 2\u001B[39m polr…    0.068\u001B[4m2\u001B[24m        0.066\u001B[4m8\u001B[24m 0.759      47.3 1.43\u001B[38;5;246me\u001B[39m\u001B[31m-11\u001B[39m     1\n\u001B[38;5;250m 3\u001B[39m polr…    0.110         0.109  0.742      80.1 3.69\u001B[38;5;246me\u001B[39m\u001B[31m-18\u001B[39m     1\n\u001B[38;5;250m 4\u001B[39m polr…    0.330         0.329  0.644     318.  3.54\u001B[38;5;246me\u001B[39m\u001B[31m-58\u001B[39m     1\n\u001B[38;5;250m 5\u001B[39m polr…    0.209         0.208  0.699     171.  7.86\u001B[38;5;246me\u001B[39m\u001B[31m-35\u001B[39m     1\n\u001B[38;5;250m 6\u001B[39m polr…    0.033\u001B[4m2\u001B[24m        0.031\u001B[4m7\u001B[24m 0.773      22.2 3.05\u001B[38;5;246me\u001B[39m\u001B[31m- 6\u001B[39m     1\n\u001B[38;5;250m 7\u001B[39m polr…    0.068\u001B[4m4\u001B[24m        0.067\u001B[4m0\u001B[24m 0.759      47.4 1.35\u001B[38;5;246me\u001B[39m\u001B[31m-11\u001B[39m     1\n\u001B[38;5;250m 8\u001B[39m polr…    0.138         0.136  0.730     103.  1.33\u001B[38;5;246me\u001B[39m\u001B[31m-22\u001B[39m     1\n\u001B[38;5;250m 9\u001B[39m polr…    0.302         0.301  0.657     280.  1.74\u001B[38;5;246me\u001B[39m\u001B[31m-52\u001B[39m     1\n\u001B[38;5;250m10\u001B[39m polr…    0.453         0.451  0.582     267.  2.88\u001B[38;5;246me\u001B[39m\u001B[31m-85\u001B[39m     2\n\u001B[38;5;246m# … with 501 more rows, and 6 more variables: logLik \u001B[3m\u001B[38;5;246m<dbl>\u001B[38;5;246m\u001B[23m,\u001B[39m\n\u001B[38;5;246m#   AIC \u001B[3m\u001B[38;5;246m<dbl>\u001B[38;5;246m\u001B[23m, BIC \u001B[3m\u001B[38;5;246m<dbl>\u001B[38;5;246m\u001B[23m, deviance \u001B[3m\u001B[38;5;246m<dbl>\u001B[38;5;246m\u001B[23m, df.residual \u001B[3m\u001B[38;5;246m<dbl>\u001B[38;5;246m\u001B[23m,\u001B[39m\n\u001B[38;5;246m#   nobs \u001B[3m\u001B[38;5;246m<dbl>\u001B[38;5;246m\u001B[23m\u001B[39m",
        "\n",
        "> ",
        "model_df5 <- subsets %>% filter(df == 5) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% head(1) %>% as.character()",
        "> ",
        "model_df5",
        "[1] \"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\"\n",
        "> ",
        "fit <- lm(model_df5, data = data)",
        "> ",
        "fit %>% broom::tidy()",
        "\u001B[38;5;246m# A tibble: 6 x 5\u001B[39m\n  term                     estimate std.error statistic  p.value\n  \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m                       \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m    \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m\n\u001B[38;5;250m1\u001B[39m (Intercept)                1.35     0.657        2.06 3.97\u001B[38;5;246me\u001B[39m\u001B[31m- 2\u001B[39m\n\u001B[38;5;250m2\u001B[39m corruption_perception_i…  -\u001B[31m0\u001B[39m\u001B[31m.\u001B[39m\u001B[31m0\u001B[39m\u001B[31m23\u001B[4m3\u001B[24m\u001B[39m   0.001\u001B[4m6\u001B[24m\u001B[4m5\u001B[24m    -\u001B[31m14\u001B[39m\u001B[31m.\u001B[39m\u001B[31m1\u001B[39m  1.65\u001B[38;5;246me\u001B[39m\u001B[31m-39\u001B[39m\n\u001B[38;5;250m3\u001B[39m edu_exp_gdp_per_person    -\u001B[31m1\u001B[39m\u001B[31m.\u001B[39m\u001B[31m90\u001B[39m     0.534       -\u001B[31m3\u001B[39m\u001B[31m.\u001B[39m\u001B[31m56\u001B[39m 3.97\u001B[38;5;246me\u001B[39m\u001B[31m- 4\u001B[39m\n\u001B[38;5;250m4\u001B[39m life_expectancy_years      0.020\u001B[4m9\u001B[24m   0.008\u001B[4m4\u001B[24m\u001B[4m0\u001B[24m      2.49 1.32\u001B[38;5;246me\u001B[39m\u001B[31m- 2\u001B[39m\n\u001B[38;5;250m5\u001B[39m military_spending_pct_o…   0.150    0.018\u001B[4m6\u001B[24m       8.05 3.95\u001B[38;5;246me\u001B[39m\u001B[31m-15\u001B[39m\n\u001B[38;5;250m6\u001B[39m murder_per_mil_people      0.035\u001B[4m0\u001B[24m   0.004\u001B[4m2\u001B[24m\u001B[4m8\u001B[24m      8.18 1.57\u001B[38;5;246me\u001B[39m\u001B[31m-15\u001B[39m",
        "\n",
        "> ",
        "summary(fit)",
        "\nCall:\nlm(formula = model_df5, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.0201 -0.3555 -0.0264  0.2132  3.8381 \n\nCoefficients:\n                                 Estimate Std. Error t value\n(Intercept)                      1.354357   0.657128   2.061\ncorruption_perception_index_cpi -0.023329   0.001655 -14.096\nedu_exp_gdp_per_person          -1.900341   0.533705  -3.561\nlife_expectancy_years            0.020873   0.008397   2.486\nmilitary_spending_pct_of_gdp     0.149871   0.018612   8.052",
        "\nmurder_per_mil_people            0.034992   0.004280   8.176\n                                Pr(>|t|)    \n(Intercept)                     0.039703 *  \ncorruption_perception_index_cpi  < 2e-16 ***\nedu_exp_gdp_per_person          0.000397 ***\nlife_expectancy_years           0.013177 *  \nmilitary_spending_pct_of_gdp    3.95e-15 ***\nmurder_per_mil_people           1.57e-15 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.531 on 642 degrees of freedom",
        "\nMultiple R-squared:  0.5471,\tAdjusted R-squared:  0.5436 \nF-statistic: 155.1 on 5 and 642 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "summary(fit)",
        "\nCall:\nlm(formula = model_df5, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.0201 -0.3555 -0.0264  0.2132  3.8381 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      1.354357   0.657128   2.061 0.039703 *  \ncorruption_perception_index_cpi -0.023329   0.001655 -14.096  < 2e-16 ***\nedu_exp_gdp_per_person          -1.900341   0.533705  -3.561 0.000397 ***\nlife_expectancy_years            0.020873   0.008397   2.486 0.013177",
        " *  \nmilitary_spending_pct_of_gdp     0.149871   0.018612   8.052 3.95e-15 ***\nmurder_per_mil_people            0.034992   0.004280   8.176 1.57e-15 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.531 on 642 degrees of freedom\nMultiple R-squared:  0.5471,\tAdjusted R-squared:  0.5436 \nF-statistic: 155.1 on 5 and 642 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "# Read and Clean ----------------------------------------------------------",
        "> ",
        "files <- list.files(path = here::here(\"raw_data\"), pattern = \".csv\")",
        "> ",
        "cleaning <- function(df){",
        "+ ",
        "  df <- pivot_longer(df, cols = -country, names_to = \"year\")",
        "+ ",
        "}",
        "> ",
        "data <- files %>% ",
        "+ ",
        "  map(function(x) read_csv(paste0(\"raw_data/\", x))) %>% ",
        "+ ",
        "  setNames(gsub(\"\\\\.csv$\", \"\", files)) %>% ",
        "+ ",
        "  map(cleaning) %>% ",
        "+ ",
        "  bind_rows(.id = \"id\") %>% ",
        "+ ",
        "  pivot_wider(names_from = id)",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m──────────────────────────────────────────────────────────\u001B[39m\ncols(\n  country = \u001B[31mcol_character()\u001B[39m,\n  `2012` = \u001B[32mcol_double()\u001B[39m,\n  `2013` = \u001B[32mcol_double()\u001B[39m,\n  `2014` = \u001B[32mcol_double()\u001B[39m,\n  `2015` = \u001B[32mcol_double()\u001B[39m,\n  `2016` = \u001B[32mcol_double()\u001B[39m,\n  `2017` = \u001B[32mcol_double()\u001B[39m\n)\n\n\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m──────────────────────────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m,\n  `1996` = \u001B[33mcol_logical()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m──────────────────────────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m──────────────────────────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m──────────────────────────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m,\n  `1961` = \u001B[33mcol_logical()\u001B[39m,\n  `1962` = \u001B[33mcol_logical()\u001B[39m,\n  `1963` = \u001B[33mcol_logical()\u001B[39m,\n  `1964` = \u001B[33mcol_logical()\u001B[39m,\n  `1966` = \u001B[33mcol_logical()\u001B[39m,\n  `1967` = \u001B[33mcol_logical()\u001B[39m,\n  `1968` = \u001B[33mcol_logical()\u001B[39m,\n  `1969` = \u001B[33mcol_logical()\u001B[39m,\n  `1971` = \u001B[33mcol_logical()\u001B[39m,\n  `1972` = \u001B[33mcol_logical()\u001B[39m,\n  `1973` = \u001B[33mcol_logical()\u001B[39m,\n  `1974` = \u001B[33mcol_logical()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m──────────────────────────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m──────────────────────────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m──────────────────────────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m──────────────────────────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m──────────────────────────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m,\n  `1982` = \u001B[33mcol_logical()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n",
        "> ",
        "countries <- readRDS(here::here(\"data\", \"countries.RDS\"))",
        "> ",
        "write_csv(data, here::here(\"data\", \"df.csv\"))",
        "> ",
        "skimr::skim(ungroup(data))",
        "── Data Summary ────────────────────────\n                           Values       \nName                       ungroup(data)\nNumber of rows             58215        \nNumber of columns          12           \n_______________________                 \nColumn type frequency:                  \n  character                2            \n  numeric                  10           \n________________________                \nGroup variables            None         \n\n── Variable type: character ──────────────────────────────────────────────────────",
        "\n  skim_variable n_missing complete_rate   min   max empty n_unique whitespace\n1 country               0             1     3    30     0      195          0\n2 year                  0             1     4     4     0      301          0\n\n── Variable type: numeric ────────────────────────────────────────────────────────\n   skim_variable                           n_missing complete_rate      mean\n",
        " 1 corruption_perception_index_cpi             57184        0.0177   42.7   \n 2 edu_exp_gdp_per_person                      56669        0.0266    0.158 \n 3 electricity_use_per_person                  52470        0.0987 3160.    \n 4 gini                                        11220        0.807    39.9   \n 5 internet_users                              53385        0.0830   22.2   \n 6 labour_force_participation_rate_percent     50876        0.126     0.623 \n 7 life_expectancy_years                        2687        0.954    53.0   ",
        "\n 8 military_spending_pct_of_gdp                51189        0.121     0.0280\n 9 murder_per_mil_people                       55250        0.0509    3.92  \n10 polrights_fh                                50115        0.139     3.68  \n          sd       p0      p25       p50       p75      p100 hist \n 1   19.6     8        28        38        55         92     ▃▇▃▂▂\n 2    0.0719  0.00235   0.105     0.15      0.2        0.651 ▆▇▁▁▁\n 3 4495.      5.76    384      1500      4240      54800     ▇▁▁▁▁",
        "\n 4    8.79   16        34.2      40        44         79.9   ▁▇▃▁▁\n 5   27.8     0         0.526     7.49     38.5      100     ▇▂▁▁▁\n 6    0.107   0.302     0.552     0.621     0.689      0.906 ▁▃▇▅▂\n 7   21.7     1.01     32.3      48.7      74.2       94.8   ▁▇▂▅▅\n 8    0.0328  0         0.0123    0.0196    0.0324     1.17  ▇▁▁▁▁\n 9    6.89    0.0186    0.926     1.62      4.2       88.2   ▇▁▁▁▁\n10    1.94    1         2         4         5          7     ▇▃▃▃▅",
        "\n",
        "> ",
        "",
        "> ",
        "data <- data %>%",
        "+ ",
        "  filter(year > 2000, year < 2019, country %in% countries) %>% ",
        "+ ",
        "  group_by(country) %>%",
        "+ ",
        "  mutate_at(vars(-country),list(~ifelse(is.na(.), median(., na.rm = TRUE), .))) %>% ",
        "+ ",
        "# Iceland spent 0 so I needed to manually recode that",
        "+ ",
        "  mutate(military_spending_pct_of_gdp = replace_na(military_spending_pct_of_gdp, 0)) %>% ",
        "+ ",
        "  mutate(murder_per_mil_people = replace(murder_per_mil_people, country == \"Mexico\", 29.07),",
        "+ ",
        "         # https://en.wikipedia.org/wiki/List_of_countries_by_intentional_homicide_rate",
        "+ ",
        "         # these murder rates were not included in the gapminder but i didnt want to ",
        "+ ",
        "         # lose 3 important countries in LA",
        "+ ",
        "         murder_per_mil_people = replace(murder_per_mil_people, country == \"Chile\", 4.4),",
        "+ ",
        "         murder_per_mil_people = replace(murder_per_mil_people, country == \"Colombia\", 25.34)) %>% ",
        "+ ",
        "  relocate(polrights_fh) %>% mutate(polrights_fh = (8 - polrights_fh))",
        "> ",
        "library(tidyverse)",
        "> ",
        "data <- read_csv(here::here(\"data\", \"df.csv\"))",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m──────────────────────────────────────────────────────────\u001B[39m\ncols(\n  country = \u001B[31mcol_character()\u001B[39m,\n  year = \u001B[32mcol_double()\u001B[39m,\n  corruption_perception_index_cpi = \u001B[32mcol_double()\u001B[39m,\n  edu_exp_gdp_per_person = \u001B[32mcol_double()\u001B[39m,\n  electricity_use_per_person = \u001B[32mcol_double()\u001B[39m,\n  gini = \u001B[32mcol_double()\u001B[39m,\n  internet_users = \u001B[32mcol_double()\u001B[39m,\n  labour_force_participation_rate_percent = \u001B[32mcol_double()\u001B[39m,\n  life_expectancy_years = \u001B[32mcol_double()\u001B[39m,\n  military_spending_pct_of_gdp = \u001B[32mcol_double()\u001B[39m,\n  murder_per_mil_people = \u001B[32mcol_double()\u001B[39m,\n  polrights_fh = \u001B[32mcol_double()\u001B[39m\n)\n\n",
        "> ",
        "names(data)",
        " [1] \"country\"                                \n [2] \"year\"                                   \n [3] \"corruption_perception_index_cpi\"        \n [4] \"edu_exp_gdp_per_person\"                 \n [5] \"electricity_use_per_person\"             \n [6] \"gini\"                                   \n [7] \"internet_users\"                         \n [8] \"labour_force_participation_rate_percent\"\n [9] \"life_expectancy_years\"                  \n[10] \"military_spending_pct_of_gdp\"           \n[11] \"murder_per_mil_people\"                  ",
        "\n[12] \"polrights_fh\"                           \n",
        "> ",
        "vars <- data %>% ",
        "+ ",
        "  select(-country, -year, -ends_with(\"_fh\")) %>%",
        "+ ",
        "  names()",
        "> ",
        "outcome <- \"polrights_fh\"",
        "> ",
        "models <- list()",
        "> ",
        "for (i in 1:length(vars)) {",
        "+ ",
        "  vc <- combn(vars,i)",
        "+ ",
        "  for (j in 1:ncol(vc)) {",
        "+ ",
        "    model <- as.formula(paste0(outcome, \" ~\", paste0(vc[,j], collapse = \" + \")))",
        "+ ",
        "    models <- c(models, model)",
        "+ ",
        "  }",
        "+ ",
        "}",
        "> ",
        "subsets <- map(models, function(x) lm(x, data)) %>% ",
        "+ ",
        "  map(broom::glance) %>% ",
        "+ ",
        "  setNames(models) %>% ",
        "+ ",
        "  bind_rows(.id = \"id\") %>% ",
        "+ ",
        "  distinct() %>% ",
        "+ ",
        "  rename(model = id) ",
        "> ",
        "write_csv(subsets, here::here(\"data\", \"subsets.csv\"))",
        "> ",
        "data <- readr::read_csv(here::here(\"data\", \"df.csv\"))",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m──────────────────────────────────────────────────────────\u001B[39m\ncols(\n  country = \u001B[31mcol_character()\u001B[39m,\n  year = \u001B[32mcol_double()\u001B[39m,\n  corruption_perception_index_cpi = \u001B[32mcol_double()\u001B[39m,\n  edu_exp_gdp_per_person = \u001B[32mcol_double()\u001B[39m,\n  electricity_use_per_person = \u001B[32mcol_double()\u001B[39m,\n  gini = \u001B[32mcol_double()\u001B[39m,\n  internet_users = \u001B[32mcol_double()\u001B[39m,\n  labour_force_participation_rate_percent = \u001B[32mcol_double()\u001B[39m,\n  life_expectancy_years = \u001B[32mcol_double()\u001B[39m,\n  military_spending_pct_of_gdp = \u001B[32mcol_double()\u001B[39m,\n  murder_per_mil_people = \u001B[32mcol_double()\u001B[39m,\n  polrights_fh = \u001B[32mcol_double()\u001B[39m\n)\n\n",
        "> ",
        "data %>% names()",
        " [1] \"country\"                                \n [2] \"year\"                                   \n [3] \"corruption_perception_index_cpi\"        \n [4] \"edu_exp_gdp_per_person\"                 \n [5] \"electricity_use_per_person\"             \n [6] \"gini\"                                   \n [7] \"internet_users\"                         \n [8] \"labour_force_participation_rate_percent\"\n [9] \"life_expectancy_years\"                  \n[10] \"military_spending_pct_of_gdp\"           \n[11] \"murder_per_mil_people\"                  ",
        "\n[12] \"polrights_fh\"                           \n",
        "> ",
        "View(data)",
        "> ",
        "summary(step(object = fit, direction = \"backward\"))",
        "Start:  AIC=-814.41\npolrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + \n    life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\n\n                                  Df Sum of Sq    RSS     AIC\n<none>                                         181.01 -814.41\n- life_expectancy_years            1     1.742 182.75 -810.21\n- edu_exp_gdp_per_person           1     3.575 184.59 -803.74\n- military_spending_pct_of_gdp     1    18.282 199.29 -754.07\n- murder_per_mil_people          ",
        "  1    18.846 199.86 -752.23\n- corruption_perception_index_cpi  1    56.022 237.03 -641.69\n\nCall:\nlm(formula = polrights_fh ~ corruption_perception_index_cpi + \n    edu_exp_gdp_per_person + life_expectancy_years + military_spending_pct_of_gdp + \n    murder_per_mil_people, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.0201 -0.3555 -0.0264  0.2132  3.8381 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      1.354357   0.657128",
        "   2.061 0.039703 *  \ncorruption_perception_index_cpi -0.023329   0.001655 -14.096  < 2e-16 ***\nedu_exp_gdp_per_person          -1.900341   0.533705  -3.561 0.000397 ***\nlife_expectancy_years            0.020873   0.008397   2.486 0.013177 *  \nmilitary_spending_pct_of_gdp     0.149871   0.018612   8.052 3.95e-15 ***\nmurder_per_mil_people            0.034992   0.004280   8.176 1.57e-15 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.531 on",
        " 642 degrees of freedom\nMultiple R-squared:  0.5471,\tAdjusted R-squared:  0.5436 \nF-statistic: 155.1 on 5 and 642 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "subsets",
        "\u001B[38;5;246m# A tibble: 511 x 13\u001B[39m\n   model r.squared adj.r.squared sigma statistic   p.value    df  logLik    AIC\n   \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m         \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m   \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m  \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m\n\u001B[38;5;250m 1\u001B[39m polr…   0.530         0.529    1.30    \u001B[4m1\u001B[24m159.  9.45\u001B[38;5;246me\u001B[39m\u001B[31m-171\u001B[39m     1  -\u001B[31m\u001B[4m1\u001B[24m73\u001B[39m\u001B[31m1\u001B[39m\u001B[31m.\u001B[39m  \u001B[4m3\u001B[24m469.\n\u001B[38;5;250m 2\u001B[39m polr…   0.114         0.113    1.55     198.  2.04\u001B[38;5;246me\u001B[39m\u001B[31m- 42\u001B[39m     1  -\u001B[31m\u001B[4m2\u001B[24m87\u001B[39m\u001B[31m4\u001B[39m\u001B[31m.\u001B[39m  \u001B[4m5\u001B[24m754.\n\u001B[38;5;250m 3\u001B[39m polr…   0.178         0.178    1.75    \u001B[4m1\u001B[24m113.  3.66\u001B[38;5;246me\u001B[39m\u001B[31m-221\u001B[39m     1 -\u001B[31m\u001B[4m1\u001B[24m\u001B[4m0\u001B[24m1\u001B[39m\u001B[31m91\u001B[39m\u001B[31m.\u001B[39m \u001B[4m2\u001B[24m\u001B[4m0\u001B[24m389.\n\u001B[38;5;250m 4\u001B[39m polr…   0.024\u001B[4m4\u001B[24m        0.024\u001B[4m3\u001B[24m   1.92     203.  1.71\u001B[38;5;246me\u001B[39m\u001B[31m- 45\u001B[39m     1 -\u001B[31m\u001B[4m1\u001B[24m\u001B[4m6\u001B[24m7\u001B[39m\u001B[31m79\u001B[39m\u001B[31m.\u001B[39m \u001B[4m3\u001B[24m\u001B[4m3\u001B[24m564.\n\u001B[38;5;250m 5\u001B[39m polr…   0.172         0.172    1.68     989.  2.17\u001B[38;5;246me\u001B[39m\u001B[31m-197\u001B[39m     1  -\u001B[31m\u001B[4m9\u001B[24m20\u001B[39m\u001B[31m2\u001B[39m\u001B[31m.\u001B[39m \u001B[4m1\u001B[24m\u001B[4m8\u001B[24m409.\n\u001B[38;5;250m 6\u001B[39m polr…   0.009\u001B[4m6\u001B[24m\u001B[4m3\u001B[24m       0.009\u001B[4m4\u001B[24m\u001B[4m4\u001B[24m  1.84      49.3 2.48\u001B[38;5;246me\u001B[39m\u001B[31m- 12\u001B[39m     1 -\u001B[31m\u001B[4m1\u001B[24m\u001B[4m0\u001B[24m2\u001B[39m\u001B[31m78\u001B[39m\u001B[31m.\u001B[39m \u001B[4m2\u001B[24m\u001B[4m0\u001B[24m563.\n\u001B[38;5;250m 7\u001B[39m polr…   0.275         0.275    1.64    \u001B[4m2\u001B[24m985.  0.  \u001B[38;5;246m \u001B[39m         1 -\u001B[31m\u001B[4m1\u001B[24m\u001B[4m5\u001B[24m0\u001B[39m\u001B[31m37\u001B[39m\u001B[31m.\u001B[39m \u001B[4m3\u001B[24m\u001B[4m0\u001B[24m080.\n\u001B[38;5;250m 8\u001B[39m polr…   0.073\u001B[4m3\u001B[24m        0.073\u001B[4m2\u001B[24m   1.76     474.  3.08\u001B[38;5;246me\u001B[39m\u001B[31m-101\u001B[39m     1 -\u001B[31m\u001B[4m1\u001B[24m\u001B[4m1\u001B[24m8\u001B[39m\u001B[31m90\u001B[39m\u001B[31m.\u001B[39m \u001B[4m2\u001B[24m\u001B[4m3\u001B[24m786.\n\u001B[38;5;250m 9\u001B[39m polr…   0.070\u001B[4m5\u001B[24m        0.070\u001B[4m0\u001B[24m   1.55     157.  7.58\u001B[38;5;246me\u001B[39m\u001B[31m- 35\u001B[39m     1  -\u001B[31m\u001B[4m3\u001B[24m85\u001B[39m\u001B[31m1\u001B[39m\u001B[31m.\u001B[39m  \u001B[4m7\u001B[24m709.\n\u001B[38;5;250m10\u001B[39m polr…   0.623         0.622    1.02     374.  1.45\u001B[38;5;246me\u001B[39m\u001B[31m- 96\u001B[39m     2   -\u001B[31m651\u001B[39m\u001B[31m.\u001B[39m  \u001B[4m1\u001B[24m310.\n\u001B[38;5;246m# … with 501 more rows, and 4 more variables: BIC \u001B[3m\u001B[38;5;246m<dbl>\u001B[38;5;246m\u001B[23m, deviance \u001B[3m\u001B[38;5;246m<dbl>\u001B[38;5;246m\u001B[23m,\u001B[39m\n\u001B[38;5;246m#   df.residual \u001B[3m\u001B[38;5;246m<int>\u001B[38;5;246m\u001B[23m, nobs \u001B[3m\u001B[38;5;246m<int>\u001B[38;5;246m\u001B[23m\u001B[39m",
        "\n",
        "> ",
        "model_df5",
        "[1] \"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\"\n",
        "> ",
        "fit <- lm(polrights_fh ~ corruption_perception_index_cpi + ",
        "+ ",
        "            edu_exp_gdp_per_person + ",
        "+ ",
        "           # electricity_use_per_person + ",
        "+ ",
        "          # gini + ",
        "+ ",
        "           # internet_users + ",
        "+ ",
        "            #labour_force_participation_rate_percent + ",
        "+ ",
        "            life_expectancy_years + ",
        "+ ",
        "            military_spending_pct_of_gdp + ",
        "+ ",
        "            murder_per_mil_people, data)",
        "> ",
        "model_df5 <- subsets %>% filter(df == 5) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% head(1) %>% as.character()",
        "> ",
        "fit <- lm(model_df5, data = data)",
        "> ",
        "fit %>% broom::tidy()",
        "\u001B[38;5;246m# A tibble: 6 x 5\u001B[39m\n  term                                    estimate std.error statistic  p.value\n  \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m                                      \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m    \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m\n\u001B[38;5;250m1\u001B[39m (Intercept)                               6.47     0.723        8.95 1.17\u001B[38;5;246me\u001B[39m\u001B[31m-17\u001B[39m\n\u001B[38;5;250m2\u001B[39m corruption_perception_index_cpi          -\u001B[31m0\u001B[39m\u001B[31m.\u001B[39m\u001B[31m0\u001B[39m\u001B[31m44\u001B[4m6\u001B[24m\u001B[39m   0.003\u001B[4m3\u001B[24m\u001B[4m4\u001B[24m    -\u001B[31m13\u001B[39m\u001B[31m.\u001B[39m\u001B[31m4\u001B[39m  3.60\u001B[38;5;246me\u001B[39m\u001B[31m-34\u001B[39m\n\u001B[38;5;250m3\u001B[39m edu_exp_gdp_per_person                   -\u001B[31m5\u001B[39m\u001B[31m.\u001B[39m\u001B[31m47\u001B[39m     0.764       -\u001B[31m7\u001B[39m\u001B[31m.\u001B[39m\u001B[31m15\u001B[39m 3.84\u001B[38;5;246me\u001B[39m\u001B[31m-12\u001B[39m\n\u001B[38;5;250m4\u001B[39m labour_force_participation_rate_percent   1.24     0.517        2.40 1.69\u001B[38;5;246me\u001B[39m\u001B[31m- 2\u001B[39m\n\u001B[38;5;250m5\u001B[39m life_expectancy_years                    -\u001B[31m0\u001B[39m\u001B[31m.\u001B[39m\u001B[31m0\u001B[39m\u001B[31m27\u001B[4m3\u001B[24m\u001B[39m   0.009\u001B[4m0\u001B[24m\u001B[4m2\u001B[24m     -\u001B[31m3\u001B[39m\u001B[31m.\u001B[39m\u001B[31m0\u001B[39m\u001B[31m3\u001B[39m 2.60\u001B[38;5;246me\u001B[39m\u001B[31m- 3\u001B[39m\n\u001B[38;5;250m6\u001B[39m military_spending_pct_of_gdp             34.7      3.95         8.80 3.78\u001B[38;5;246me\u001B[39m\u001B[31m-17\u001B[39m",
        "\n",
        "> ",
        "summary(fit)",
        "\nCall:\nlm(formula = model_df5, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.7813 -0.6528 -0.1022  0.5375  2.6881 \n\nCoefficients:\n                                         Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                              6.473344   0.723146   8.952  < 2e-16 ***\ncorruption_perception_index_cpi         -0.044648   0.003339 -13.371  < 2e-16 ***\nedu_exp_gdp_per_person                  -5.467862   0.764349  -7.154 3.84e-12 ***\nlabour_force_participation_rate_percent",
        "  1.239195   0.516539   2.399   0.0169 *  \nlife_expectancy_years                   -0.027338   0.009023  -3.030   0.0026 ** \nmilitary_spending_pct_of_gdp            34.706944   3.945377   8.797  < 2e-16 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.9092 on 416 degrees of freedom\n  (57793 observations deleted due to missingness)\nMultiple R-squared:  0.6952,\tAdjusted R-squared:  0.6915 \nF-statistic: 189.8 on 5 and 416 DF,  p-value: < 2.2e-16",
        "\n\n",
        "> ",
        "fit <- lm(polrights_fh ~ corruption_perception_index_cpi + ",
        "+ ",
        "            edu_exp_gdp_per_person + ",
        "+ ",
        "           # electricity_use_per_person + ",
        "+ ",
        "          # gini + ",
        "+ ",
        "           # internet_users + ",
        "+ ",
        "            #labour_force_participation_rate_percent + ",
        "+ ",
        "            life_expectancy_years + ",
        "+ ",
        "            military_spending_pct_of_gdp + ",
        "+ ",
        "            murder_per_mil_people, data)",
        "> ",
        "summary(fit)",
        "\nCall:\nlm(formula = polrights_fh ~ corruption_perception_index_cpi + \n    edu_exp_gdp_per_person + life_expectancy_years + military_spending_pct_of_gdp + \n    murder_per_mil_people, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.1201 -0.5500 -0.0145  0.3325  2.9091 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      8.710980   2.307226   3.776 0.000238 ***\ncorruption_perception_index_cpi -0.025240   0.005285  -4.776",
        " 4.59e-06 ***\nedu_exp_gdp_per_person          -2.691912   1.149957  -2.341 0.020703 *  \nlife_expectancy_years           -0.069587   0.031951  -2.178 0.031151 *  \nmilitary_spending_pct_of_gdp    31.426588   6.302784   4.986 1.86e-06 ***\nmurder_per_mil_people            0.031016   0.071747   0.432 0.666221    \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.7391 on 135 degrees of freedom\n  (58074 observations deleted due to missingness)\nMultiple R-squared: ",
        " 0.5197,\tAdjusted R-squared:  0.5019 \nF-statistic: 29.21 on 5 and 135 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "data <- readr::read_csv(here::here(\"data\", \"df.csv\"))",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m─────────\u001B[39m\ncols(\n  country = \u001B[31mcol_character()\u001B[39m,\n  year = \u001B[32mcol_double()\u001B[39m,\n  corruption_perception_index_cpi = \u001B[32mcol_double()\u001B[39m,\n  edu_exp_gdp_per_person = \u001B[32mcol_double()\u001B[39m,\n  electricity_use_per_person = \u001B[32mcol_double()\u001B[39m,\n  gini = \u001B[32mcol_double()\u001B[39m,\n  internet_users = \u001B[32mcol_double()\u001B[39m,\n  labour_force_participation_rate_percent = \u001B[32mcol_double()\u001B[39m,\n  life_expectancy_years = \u001B[32mcol_double()\u001B[39m,\n  military_spending_pct_of_gdp = \u001B[32mcol_double()\u001B[39m,\n  murder_per_mil_people = \u001B[32mcol_double()\u001B[39m,\n  polrights_fh = \u001B[32mcol_double()\u001B[39m\n)\n\n",
        "> ",
        "data %>% names()",
        " [1] \"country\"                                \n [2] \"year\"                                   \n [3] \"corruption_perception_index_cpi\"        \n [4] \"edu_exp_gdp_per_person\"                 \n [5] \"electricity_use_per_person\"             \n [6] \"gini\"                                   \n [7] \"internet_users\"                         \n [8] \"labour_force_participation_rate_percent\"\n [9] \"life_expectancy_years\"                  \n[10] \"military_spending_pct_of_gdp\"           \n[11] \"murder_per_mil_people\"                  ",
        "\n[12] \"polrights_fh\"                           \n",
        "> ",
        "fit <- lm(polrights_fh ~ corruption_perception_index_cpi + ",
        "+ ",
        "            edu_exp_gdp_per_person + ",
        "+ ",
        "           # electricity_use_per_person + ",
        "+ ",
        "          # gini + ",
        "+ ",
        "           # internet_users + ",
        "+ ",
        "            #labour_force_participation_rate_percent + ",
        "+ ",
        "            life_expectancy_years + ",
        "+ ",
        "            military_spending_pct_of_gdp + ",
        "+ ",
        "            murder_per_mil_people, data)",
        "> ",
        "summary(step(object = fit, direction = \"backward\"))",
        "Start:  AIC=-79.37\npolrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + \n    life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\n\n                                  Df\n- murder_per_mil_people            1\n<none>                              \n- life_expectancy_years            1\n- edu_exp_gdp_per_person           1\n- corruption_perception_index_cpi  1\n- military_spending_pct_of_gdp     1\n                                  Sum of Sq\n- murder_per_mil_people          ",
        "    0.1021\n<none>                                     \n- life_expectancy_years              2.5914\n- edu_exp_gdp_per_person             2.9937\n- corruption_perception_index_cpi   12.4630\n- military_spending_pct_of_gdp      13.5826\n                                     RSS\n- murder_per_mil_people           73.856\n<none>                            73.754\n- life_expectancy_years           76.346\n- edu_exp_gdp_per_person          76.748\n- corruption_perception_index_cpi 86.217\n- military_spending_pct_of_gdp    87.337",
        "\n                                      AIC\n- murder_per_mil_people           -81.176\n<none>                            -79.371\n- life_expectancy_years           -76.502\n- edu_exp_gdp_per_person          -75.761\n- corruption_perception_index_cpi -59.356\n- military_spending_pct_of_gdp    -57.537\n",
        "Error in step(object = fit, direction = \"backward\") : \n  number of rows in use has changed: remove missing values?\n",
        "> ",
        "fit <- lm(polrights_fh ~ corruption_perception_index_cpi + ",
        "+ ",
        "            edu_exp_gdp_per_person + ",
        "+ ",
        "           # electricity_use_per_person + ",
        "+ ",
        "          # gini + ",
        "+ ",
        "           # internet_users + ",
        "+ ",
        "            #labour_force_participation_rate_percent + ",
        "+ ",
        "            life_expectancy_years + ",
        "+ ",
        "            military_spending_pct_of_gdp + ",
        "+ ",
        "            murder_per_mil_people, data)",
        "> ",
        "summary(step(object = fit, direction = \"backward\"))",
        "Start:  AIC=-79.37\npolrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + \n    life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\n\n                                  Df Sum of Sq    RSS\n- murder_per_mil_people            1    0.1021 73.856\n<none>                                         73.754\n- life_expectancy_years            1    2.5914 76.346\n- edu_exp_gdp_per_person           1    2.9937 76.748\n- corruption_perception_index_cpi  1   12.4630 86.217\n- military_spending_pct_of_gdp   ",
        "  1   13.5826 87.337\n                                      AIC\n- murder_per_mil_people           -81.176\n<none>                            -79.371\n- life_expectancy_years           -76.502\n- edu_exp_gdp_per_person          -75.761\n- corruption_perception_index_cpi -59.356\n- military_spending_pct_of_gdp    -57.537\n",
        "Error in step(object = fit, direction = \"backward\") : \n  number of rows in use has changed: remove missing values?\n",
        "> ",
        "subsets",
        "\u001B[38;5;246m# A tibble: 511 x 13\u001B[39m\n   model r.squared adj.r.squared sigma statistic\n   \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m         \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m\n\u001B[38;5;250m 1\u001B[39m polr…   0.530         0.529    1.30    \u001B[4m1\u001B[24m159. \n\u001B[38;5;250m 2\u001B[39m polr…   0.114         0.113    1.55     198. \n\u001B[38;5;250m 3\u001B[39m polr…   0.178         0.178    1.75    \u001B[4m1\u001B[24m113. \n\u001B[38;5;250m 4\u001B[39m polr…   0.024\u001B[4m4\u001B[24m        0.024\u001B[4m3\u001B[24m   1.92     203. \n\u001B[38;5;250m 5\u001B[39m polr…   0.172         0.172    1.68     989. \n\u001B[38;5;250m 6\u001B[39m polr…   0.009\u001B[4m6\u001B[24m\u001B[4m3\u001B[24m       0.009\u001B[4m4\u001B[24m\u001B[4m4\u001B[24m  1.84      49.3\n\u001B[38;5;250m 7\u001B[39m polr…   0.275         0.275    1.64    \u001B[4m2\u001B[24m985. \n\u001B[38;5;250m 8\u001B[39m polr…   0.073\u001B[4m3\u001B[24m        0.073\u001B[4m2\u001B[24m   1.76     474. \n\u001B[38;5;250m 9\u001B[39m polr…   0.070\u001B[4m5\u001B[24m        0.070\u001B[4m0\u001B[24m   1.55     157. \n\u001B[38;5;250m10\u001B[39m polr…   0.623         0.622    1.02     374. \n\u001B[38;5;246m# … with 501 more rows, and 8 more variables:\u001B[39m\n\u001B[38;5;246m#   p.value \u001B[3m\u001B[38;5;246m<dbl>\u001B[38;5;246m\u001B[23m, df \u001B[3m\u001B[38;5;246m<dbl>\u001B[38;5;246m\u001B[23m, logLik \u001B[3m\u001B[38;5;246m<dbl>\u001B[38;5;246m\u001B[23m, AIC \u001B[3m\u001B[38;5;246m<dbl>\u001B[38;5;246m\u001B[23m,\u001B[39m\n\u001B[38;5;246m#   BIC \u001B[3m\u001B[38;5;246m<dbl>\u001B[38;5;246m\u001B[23m, deviance \u001B[3m\u001B[38;5;246m<dbl>\u001B[38;5;246m\u001B[23m, df.residual \u001B[3m\u001B[38;5;246m<int>\u001B[38;5;246m\u001B[23m,\u001B[39m\n\u001B[38;5;246m#   nobs \u001B[3m\u001B[38;5;246m<int>\u001B[38;5;246m\u001B[23m\u001B[39m",
        "\n",
        "> ",
        "model_df5 <- subsets %>% filter(df == 5) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% head(1) %>% as.character()",
        "> ",
        "model_df5",
        "[1] \"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + labour_force_participation_rate_percent + life_expectancy_years + military_spending_pct_of_gdp\"\n",
        "> ",
        "fit <- lm(model_df5, data = data)",
        "> ",
        "fit %>% broom::tidy()",
        "\u001B[38;5;246m# A tibble: 6 x 5\u001B[39m\n  term           estimate std.error statistic  p.value\n  \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m             \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m    \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m\n\u001B[38;5;250m1\u001B[39m (Intercept)      6.47     0.723        8.95 1.17\u001B[38;5;246me\u001B[39m\u001B[31m-17\u001B[39m\n\u001B[38;5;250m2\u001B[39m corruption_pe…  -\u001B[31m0\u001B[39m\u001B[31m.\u001B[39m\u001B[31m0\u001B[39m\u001B[31m44\u001B[4m6\u001B[24m\u001B[39m   0.003\u001B[4m3\u001B[24m\u001B[4m4\u001B[24m    -\u001B[31m13\u001B[39m\u001B[31m.\u001B[39m\u001B[31m4\u001B[39m  3.60\u001B[38;5;246me\u001B[39m\u001B[31m-34\u001B[39m\n\u001B[38;5;250m3\u001B[39m edu_exp_gdp_p…  -\u001B[31m5\u001B[39m\u001B[31m.\u001B[39m\u001B[31m47\u001B[39m     0.764       -\u001B[31m7\u001B[39m\u001B[31m.\u001B[39m\u001B[31m15\u001B[39m 3.84\u001B[38;5;246me\u001B[39m\u001B[31m-12\u001B[39m\n\u001B[38;5;250m4\u001B[39m labour_force_…   1.24     0.517        2.40 1.69\u001B[38;5;246me\u001B[39m\u001B[31m- 2\u001B[39m\n\u001B[38;5;250m5\u001B[39m life_expectan…  -\u001B[31m0\u001B[39m\u001B[31m.\u001B[39m\u001B[31m0\u001B[39m\u001B[31m27\u001B[4m3\u001B[24m\u001B[39m   0.009\u001B[4m0\u001B[24m\u001B[4m2\u001B[24m     -\u001B[31m3\u001B[39m\u001B[31m.\u001B[39m\u001B[31m0\u001B[39m\u001B[31m3\u001B[39m 2.60\u001B[38;5;246me\u001B[39m\u001B[31m- 3\u001B[39m\n\u001B[38;5;250m6\u001B[39m military_spen…  34.7      3.95         8.80 3.78\u001B[38;5;246me\u001B[39m\u001B[31m-17\u001B[39m",
        "\n",
        "> ",
        "summary(fit)",
        "\nCall:\nlm(formula = model_df5, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.7813 -0.6528 -0.1022  0.5375  2.6881 \n\nCoefficients:\n                                         Estimate\n(Intercept)                              6.473344\ncorruption_perception_index_cpi         -0.044648\nedu_exp_gdp_per_person                  -5.467862\nlabour_force_participation_rate_percent  1.239195\nlife_expectancy_years                   -0.027338\nmilitary_spending_pct_of_gdp            34.706944\n                                       ",
        " Std. Error\n(Intercept)                               0.723146\ncorruption_perception_index_cpi           0.003339\nedu_exp_gdp_per_person                    0.764349\nlabour_force_participation_rate_percent   0.516539\nlife_expectancy_years                     0.009023\nmilitary_spending_pct_of_gdp              3.945377\n                                        t value\n(Intercept)                               8.952\ncorruption_perception_index_cpi         -13.371\nedu_exp_gdp_per_person                   -7.154\nlabour_force_participation_rate_percent",
        "   2.399\nlife_expectancy_years                    -3.030\nmilitary_spending_pct_of_gdp              8.797\n                                        Pr(>|t|)    \n(Intercept)                              < 2e-16 ***\ncorruption_perception_index_cpi          < 2e-16 ***\nedu_exp_gdp_per_person                  3.84e-12 ***\nlabour_force_participation_rate_percent   0.0169 *  \nlife_expectancy_years                     0.0026 ** \nmilitary_spending_pct_of_gdp             < 2e-16 ***\n---\nSignif. codes:  \n0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1",
        "\n\nResidual standard error: 0.9092 on 416 degrees of freedom\n  (57793 observations deleted due to missingness)\nMultiple R-squared:  0.6952,\tAdjusted R-squared:  0.6915 \nF-statistic: 189.8 on 5 and 416 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "View(data)",
        "> ",
        "library(tidyverse)",
        "> ",
        "# Read and Clean ----------------------------------------------------------",
        "> ",
        "files <- list.files(path = here::here(\"raw_data\"), pattern = \".csv\")",
        "> ",
        "cleaning <- function(df){",
        "+ ",
        "  df <- pivot_longer(df, cols = -country, names_to = \"year\")",
        "+ ",
        "}",
        "> ",
        "data <- files %>% ",
        "+ ",
        "  map(function(x) read_csv(paste0(\"raw_data/\", x))) %>% ",
        "+ ",
        "  setNames(gsub(\"\\\\.csv$\", \"\", files)) %>% ",
        "+ ",
        "  map(cleaning) %>% ",
        "+ ",
        "  bind_rows(.id = \"id\") %>% ",
        "+ ",
        "  pivot_wider(names_from = id)",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m───────────────────────────────────────\u001B[39m\ncols(\n  country = \u001B[31mcol_character()\u001B[39m,\n  `2012` = \u001B[32mcol_double()\u001B[39m,\n  `2013` = \u001B[32mcol_double()\u001B[39m,\n  `2014` = \u001B[32mcol_double()\u001B[39m,\n  `2015` = \u001B[32mcol_double()\u001B[39m,\n  `2016` = \u001B[32mcol_double()\u001B[39m,\n  `2017` = \u001B[32mcol_double()\u001B[39m\n)\n\n\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m───────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m,\n  `1996` = \u001B[33mcol_logical()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m───────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m───────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m───────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m,\n  `1961` = \u001B[33mcol_logical()\u001B[39m,\n  `1962` = \u001B[33mcol_logical()\u001B[39m,\n  `1963` = \u001B[33mcol_logical()\u001B[39m,\n  `1964` = \u001B[33mcol_logical()\u001B[39m,\n  `1966` = \u001B[33mcol_logical()\u001B[39m,\n  `1967` = \u001B[33mcol_logical()\u001B[39m,\n  `1968` = \u001B[33mcol_logical()\u001B[39m,\n  `1969` = \u001B[33mcol_logical()\u001B[39m,\n  `1971` = \u001B[33mcol_logical()\u001B[39m,\n  `1972` = \u001B[33mcol_logical()\u001B[39m,\n  `1973` = \u001B[33mcol_logical()\u001B[39m,\n  `1974` = \u001B[33mcol_logical()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m───────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m───────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m───────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m───────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m───────────────────────────────────────\u001B[39m\ncols(\n  .default = col_double(),\n  country = \u001B[31mcol_character()\u001B[39m,\n  `1982` = \u001B[33mcol_logical()\u001B[39m\n)\n\u001B[36mℹ\u001B[39m Use \u001B[38;5;251m\u001B[48;5;235m\u001B[38;5;251m\u001B[48;5;235m`spec()`\u001B[48;5;235m\u001B[38;5;251m\u001B[49m\u001B[39m for the full column specifications.\n\n",
        "> ",
        "countries <- readRDS(here::here(\"data\", \"countries.RDS\"))",
        "> ",
        "data <- data %>%",
        "+ ",
        "  filter(year > 2000, year < 2019, country %in% countries) %>% ",
        "+ ",
        "  group_by(country) %>%",
        "+ ",
        "  mutate_at(vars(-country),list(~ifelse(is.na(.), median(., na.rm = TRUE), .))) %>% ",
        "+ ",
        "# Iceland spent 0 so I needed to manually recode that",
        "+ ",
        "  mutate(military_spending_pct_of_gdp = replace_na(military_spending_pct_of_gdp, 0)) %>% ",
        "+ ",
        "  mutate(murder_per_mil_people = replace(murder_per_mil_people, country == \"Mexico\", 29.07),",
        "+ ",
        "         # https://en.wikipedia.org/wiki/List_of_countries_by_intentional_homicide_rate",
        "+ ",
        "         # these murder rates were not included in the gapminder but i didnt want to ",
        "+ ",
        "         # lose 3 important countries in LA",
        "+ ",
        "         murder_per_mil_people = replace(murder_per_mil_people, country == \"Chile\", 4.4),",
        "+ ",
        "         murder_per_mil_people = replace(murder_per_mil_people, country == \"Colombia\", 25.34)) %>% ",
        "+ ",
        "  relocate(polrights_fh) %>% mutate(polrights_fh = (8 - polrights_fh),",
        "+ ",
        "                                    military_spending_pct_of_gdp = military_spending_pct_of_gdp * 100)",
        "> ",
        "write_csv(data, here::here(\"data\", \"df.csv\"))",
        "> ",
        "data <- readr::read_csv(here::here(\"data\", \"df.csv\"))",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m───────────────────────────────────────\u001B[39m\ncols(\n  polrights_fh = \u001B[32mcol_double()\u001B[39m,\n  country = \u001B[31mcol_character()\u001B[39m,\n  year = \u001B[32mcol_double()\u001B[39m,\n  corruption_perception_index_cpi = \u001B[32mcol_double()\u001B[39m,\n  edu_exp_gdp_per_person = \u001B[32mcol_double()\u001B[39m,\n  electricity_use_per_person = \u001B[32mcol_double()\u001B[39m,\n  gini = \u001B[32mcol_double()\u001B[39m,\n  internet_users = \u001B[32mcol_double()\u001B[39m,\n  labour_force_participation_rate_percent = \u001B[32mcol_double()\u001B[39m,\n  life_expectancy_years = \u001B[32mcol_double()\u001B[39m,\n  military_spending_pct_of_gdp = \u001B[32mcol_double()\u001B[39m,\n  murder_per_mil_people = \u001B[32mcol_double()\u001B[39m\n)\n\n",
        "> ",
        "fit <- lm(polrights_fh ~ corruption_perception_index_cpi + ",
        "+ ",
        "            edu_exp_gdp_per_person + ",
        "+ ",
        "           # electricity_use_per_person + ",
        "+ ",
        "          # gini + ",
        "+ ",
        "           # internet_users + ",
        "+ ",
        "            #labour_force_participation_rate_percent + ",
        "+ ",
        "            life_expectancy_years + ",
        "+ ",
        "            military_spending_pct_of_gdp + ",
        "+ ",
        "            murder_per_mil_people, data)",
        "> ",
        "summary(fit)",
        "\nCall:\nlm(formula = polrights_fh ~ corruption_perception_index_cpi + \n    edu_exp_gdp_per_person + life_expectancy_years + military_spending_pct_of_gdp + \n    murder_per_mil_people, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.8381 -0.2132  0.0264  0.3555  1.0201 \n\nCoefficients:\n                                 Estimate Std. Error t value\n(Intercept)                      6.645643   0.657128  10.113\ncorruption_perception_index_cpi  0.023329   0.001655  14.096\nedu_exp_gdp_per_person         ",
        "  1.900341   0.533705   3.561\nlife_expectancy_years           -0.020873   0.008397  -2.486\nmilitary_spending_pct_of_gdp    -0.149871   0.018612  -8.052\nmurder_per_mil_people           -0.034992   0.004280  -8.176\n                                Pr(>|t|)    \n(Intercept)                      < 2e-16 ***\ncorruption_perception_index_cpi  < 2e-16 ***\nedu_exp_gdp_per_person          0.000397 ***\nlife_expectancy_years           0.013177 *  \nmilitary_spending_pct_of_gdp    3.95e-15 ***\nmurder_per_mil_people          ",
        " 1.57e-15 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.531 on 642 degrees of freedom\nMultiple R-squared:  0.5471,\tAdjusted R-squared:  0.5436 \nF-statistic: 155.1 on 5 and 642 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "summary(fit)",
        "\nCall:\nlm(formula = polrights_fh ~ corruption_perception_index_cpi + \n    edu_exp_gdp_per_person + life_expectancy_years + military_spending_pct_of_gdp + \n    murder_per_mil_people, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.8381 -0.2132  0.0264  0.3555  1.0201 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      6.645643   0.657128  10.113  < 2e-16 ***\ncorruption_perception_index_cpi  0.023329   0.001655  14.096",
        "  < 2e-16 ***\nedu_exp_gdp_per_person           1.900341   0.533705   3.561 0.000397 ***\nlife_expectancy_years           -0.020873   0.008397  -2.486 0.013177 *  \nmilitary_spending_pct_of_gdp    -0.149871   0.018612  -8.052 3.95e-15 ***\nmurder_per_mil_people           -0.034992   0.004280  -8.176 1.57e-15 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.531 on 642 degrees of freedom\nMultiple R-squared:  0.5471,\tAdjusted R-squared:  0.5436 ",
        "\nF-statistic: 155.1 on 5 and 642 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "model_df5 <- lm(polrights_fh ~ corruption_perception_index_cpi + ",
        "+ ",
        "            edu_exp_gdp_per_person + ",
        "+ ",
        "            life_expectancy_years + ",
        "+ ",
        "            military_spending_pct_of_gdp + ",
        "+ ",
        "            murder_per_mil_people, data)",
        "> ",
        "summary(step(object = fit, direction = \"backward\"))",
        "Start:  AIC=-814.41\npolrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + \n    life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\n\n                                  Df Sum of Sq    RSS     AIC\n<none>                                         181.01 -814.41\n- life_expectancy_years            1     1.742 182.75 -810.21\n- edu_exp_gdp_per_person           1     3.575 184.59 -803.74\n- military_spending_pct_of_gdp     1    18.282 199.29 -754.07\n- murder_per_mil_people          ",
        "  1    18.846 199.86 -752.23\n- corruption_perception_index_cpi  1    56.022 237.03 -641.69\n\nCall:\nlm(formula = polrights_fh ~ corruption_perception_index_cpi + \n    edu_exp_gdp_per_person + life_expectancy_years + military_spending_pct_of_gdp + \n    murder_per_mil_people, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.8381 -0.2132  0.0264  0.3555  1.0201 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      6.645643   0.657128",
        "  10.113  < 2e-16 ***\ncorruption_perception_index_cpi  0.023329   0.001655  14.096  < 2e-16 ***\nedu_exp_gdp_per_person           1.900341   0.533705   3.561 0.000397 ***\nlife_expectancy_years           -0.020873   0.008397  -2.486 0.013177 *  \nmilitary_spending_pct_of_gdp    -0.149871   0.018612  -8.052 3.95e-15 ***\nmurder_per_mil_people           -0.034992   0.004280  -8.176 1.57e-15 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.531 on",
        " 642 degrees of freedom\nMultiple R-squared:  0.5471,\tAdjusted R-squared:  0.5436 \nF-statistic: 155.1 on 5 and 642 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "summary(step(object = fit, direction = \"forward\"))",
        "Start:  AIC=-814.41\npolrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + \n    life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\n\n\nCall:\nlm(formula = polrights_fh ~ corruption_perception_index_cpi + \n    edu_exp_gdp_per_person + life_expectancy_years + military_spending_pct_of_gdp + \n    murder_per_mil_people, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.8381 -0.2132  0.0264  0.3555  1.0201 \n\nCoefficients:\n                               ",
        "  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      6.645643   0.657128  10.113  < 2e-16 ***\ncorruption_perception_index_cpi  0.023329   0.001655  14.096  < 2e-16 ***\nedu_exp_gdp_per_person           1.900341   0.533705   3.561 0.000397 ***\nlife_expectancy_years           -0.020873   0.008397  -2.486 0.013177 *  \nmilitary_spending_pct_of_gdp    -0.149871   0.018612  -8.052 3.95e-15 ***\nmurder_per_mil_people           -0.034992   0.004280  -8.176 1.57e-15 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1",
        "\n\nResidual standard error: 0.531 on 642 degrees of freedom\nMultiple R-squared:  0.5471,\tAdjusted R-squared:  0.5436 \nF-statistic: 155.1 on 5 and 642 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "summary(step(object = fit, direction = \"forward\"))",
        "Start:  AIC=-814.41\npolrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + \n    life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\n\n\nCall:\nlm(formula = polrights_fh ~ corruption_perception_index_cpi + \n    edu_exp_gdp_per_person + life_expectancy_years + military_spending_pct_of_gdp + \n    murder_per_mil_people, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.8381 -0.2132  0.0264  0.3555  1.0201 \n\nCoefficients:\n                               ",
        "  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      6.645643   0.657128  10.113  < 2e-16 ***\ncorruption_perception_index_cpi  0.023329   0.001655  14.096  < 2e-16 ***\nedu_exp_gdp_per_person           1.900341   0.533705   3.561 0.000397 ***\nlife_expectancy_years           -0.020873   0.008397  -2.486 0.013177 *  \nmilitary_spending_pct_of_gdp    -0.149871   0.018612  -8.052 3.95e-15 ***\nmurder_per_mil_people           -0.034992   0.004280  -8.176 1.57e-15 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1",
        "\n\nResidual standard error: 0.531 on 642 degrees of freedom\nMultiple R-squared:  0.5471,\tAdjusted R-squared:  0.5436 \nF-statistic: 155.1 on 5 and 642 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "subsets %>% filter(df == 20) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% head(1) %>% as.character()",
        "[1] \"character(0)\"\n",
        "> ",
        "subsets %>% filter(df == 10) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% head(1) %>% as.character()",
        "[1] \"character(0)\"\n",
        "> ",
        "subsets %>% filter(df == 9) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% head(1) %>% as.character()",
        "[1] \"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + electricity_use_per_person + gini + internet_users + labour_force_participation_rate_percent + life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\"\n",
        "> ",
        "lm(polrights_fh ~ corruption_perception_index_cpi + ",
        "+ ",
        "  edu_exp_gdp_per_person + ",
        "+ ",
        "  electricity_use_per_person + ",
        "+ ",
        "  gini + ",
        "+ ",
        "  internet_users + ",
        "+ ",
        "  labour_force_participation_rate_percent + ",
        "+ ",
        "  life_expectancy_years +",
        "+ ",
        "  military_spending_pct_of_gdp +",
        "+ ",
        "  murder_per_mil_people, data)",
        "\nCall:\nlm(formula = polrights_fh ~ corruption_perception_index_cpi + \n    edu_exp_gdp_per_person + electricity_use_per_person + gini + \n    internet_users + labour_force_participation_rate_percent + \n    life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people, \n    data = data)\n\nCoefficients:\n                            (Intercept)  \n                              6.777e+00  \n        corruption_perception_index_cpi  \n                              2.262e-02  \n                 edu_exp_gdp_per_person  ",
        "\n                              1.650e+00  \n             electricity_use_per_person  \n                             -4.199e-06  \n                                   gini  \n                             -4.679e-03  \n                         internet_users  \n                              1.054e-03  \nlabour_force_participation_rate_percent  \n                              2.484e-01  \n                  life_expectancy_years  \n                             -2.182e-02  \n           military_spending_pct_of_gdp  \n                             -1.421e-01  ",
        "\n                  murder_per_mil_people  \n                             -3.356e-02  \n\n",
        "> ",
        "back <- lm(polrights_fh ~ corruption_perception_index_cpi + ",
        "+ ",
        "  edu_exp_gdp_per_person + ",
        "+ ",
        "  electricity_use_per_person + ",
        "+ ",
        "  gini + ",
        "+ ",
        "  internet_users + ",
        "+ ",
        "  labour_force_participation_rate_percent + ",
        "+ ",
        "  life_expectancy_years +",
        "+ ",
        "  military_spending_pct_of_gdp +",
        "+ ",
        "  murder_per_mil_people, data)",
        "> ",
        "summary(step(object = back, direction = \"forward\"))",
        "Start:  AIC=-808.7\npolrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + \n    electricity_use_per_person + gini + internet_users + labour_force_participation_rate_percent + \n    life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\n\n\nCall:\nlm(formula = polrights_fh ~ corruption_perception_index_cpi + \n    edu_exp_gdp_per_person + electricity_use_per_person + gini + \n    internet_users + labour_force_participation_rate_percent + \n    life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people, \n    data = data)",
        "\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.8490 -0.2113  0.0307  0.3478  1.0485 \n\nCoefficients:\n                                          Estimate Std. Error t value\n(Intercept)                              6.777e+00  7.740e-01   8.756\ncorruption_perception_index_cpi          2.262e-02  2.181e-03  10.373\nedu_exp_gdp_per_person                   1.650e+00  5.932e-01   2.782\nelectricity_use_per_person              -4.199e-06  3.821e-06  -1.099\ngini                                    -4.679e-03  6.175e-03",
        "  -0.758\ninternet_users                           1.054e-03  1.407e-03   0.749\nlabour_force_participation_rate_percent  2.484e-01  5.823e-01   0.427\nlife_expectancy_years                   -2.182e-02  9.973e-03  -2.188\nmilitary_spending_pct_of_gdp            -1.421e-01  2.205e-02  -6.445\nmurder_per_mil_people                   -3.356e-02  6.355e-03  -5.281\n                                        Pr(>|t|)    \n(Intercept)                              < 2e-16 ***\ncorruption_perception_index_cpi          < 2e-16",
        " ***\nedu_exp_gdp_per_person                   0.00557 ** \nelectricity_use_per_person               0.27229    \ngini                                     0.44895    \ninternet_users                           0.45404    \nlabour_force_participation_rate_percent  0.66985    \nlife_expectancy_years                    0.02906 *  \nmilitary_spending_pct_of_gdp            2.29e-10 ***\nmurder_per_mil_people                   1.77e-07 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1",
        "\n\nResidual standard error: 0.5317 on 638 degrees of freedom\nMultiple R-squared:  0.5487,\tAdjusted R-squared:  0.5423 \nF-statistic: 86.19 on 9 and 638 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "summary(step(object = back, direction = \"forward\"))",
        "Start:  AIC=-808.7\npolrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + \n    electricity_use_per_person + gini + internet_users + labour_force_participation_rate_percent + \n    life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\n\n\nCall:\nlm(formula = polrights_fh ~ corruption_perception_index_cpi + \n    edu_exp_gdp_per_person + electricity_use_per_person + gini + \n    internet_users + labour_force_participation_rate_percent + \n    life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people, \n    data = data)",
        "\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.8490 -0.2113  0.0307  0.3478  1.0485 \n\nCoefficients:\n                                          Estimate Std. Error t value\n(Intercept)                              6.777e+00  7.740e-01   8.756\ncorruption_perception_index_cpi          2.262e-02  2.181e-03  10.373\nedu_exp_gdp_per_person                   1.650e+00  5.932e-01   2.782\nelectricity_use_per_person              -4.199e-06  3.821e-06  -1.099\ngini                                    -4.679e-03  6.175e-03",
        "  -0.758\ninternet_users                           1.054e-03  1.407e-03   0.749\nlabour_force_participation_rate_percent  2.484e-01  5.823e-01   0.427\nlife_expectancy_years                   -2.182e-02  9.973e-03  -2.188\nmilitary_spending_pct_of_gdp            -1.421e-01  2.205e-02  -6.445\nmurder_per_mil_people                   -3.356e-02  6.355e-03  -5.281\n                                        Pr(>|t|)    \n(Intercept)                              < 2e-16 ***\ncorruption_perception_index_cpi          < 2e-16",
        " ***\nedu_exp_gdp_per_person                   0.00557 ** \nelectricity_use_per_person               0.27229    \ngini                                     0.44895    \ninternet_users                           0.45404    \nlabour_force_participation_rate_percent  0.66985    \nlife_expectancy_years                    0.02906 *  \nmilitary_spending_pct_of_gdp            2.29e-10 ***\nmurder_per_mil_people                   1.77e-07 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1",
        "\n\nResidual standard error: 0.5317 on 638 degrees of freedom\nMultiple R-squared:  0.5487,\tAdjusted R-squared:  0.5423 \nF-statistic: 86.19 on 9 and 638 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "summary(step(object = back, direction = \"forward\"))",
        "Start:  AIC=-808.7\npolrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + \n    electricity_use_per_person + gini + internet_users + labour_force_participation_rate_percent + \n    life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\n\n\nCall:\nlm(formula = polrights_fh ~ corruption_perception_index_cpi + \n    edu_exp_gdp_per_person + electricity_use_per_person + gini + \n    internet_users + labour_force_participation_rate_percent + \n    life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people, \n    data = data)",
        "\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.8490 -0.2113  0.0307  0.3478  1.0485 \n\nCoefficients:\n                                          Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                              6.777e+00  7.740e-01   8.756  < 2e-16 ***\ncorruption_perception_index_cpi          2.262e-02  2.181e-03  10.373  < 2e-16 ***\nedu_exp_gdp_per_person                   1.650e+00  5.932e-01   2.782  0.00557 ** \nelectricity_use_per_person              -4.199e-06  3.821e-06  -1.099  0.27229",
        "    \ngini                                    -4.679e-03  6.175e-03  -0.758  0.44895    \ninternet_users                           1.054e-03  1.407e-03   0.749  0.45404    \nlabour_force_participation_rate_percent  2.484e-01  5.823e-01   0.427  0.66985    \nlife_expectancy_years                   -2.182e-02  9.973e-03  -2.188  0.02906 *  \nmilitary_spending_pct_of_gdp            -1.421e-01  2.205e-02  -6.445 2.29e-10 ***\nmurder_per_mil_people                   -3.356e-02  6.355e-03  -5.281 1.77e-07 ***\n---\nSignif. codes:  ",
        "0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.5317 on 638 degrees of freedom\nMultiple R-squared:  0.5487,\tAdjusted R-squared:  0.5423 \nF-statistic: 86.19 on 9 and 638 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "back <- lm(polrights_fh ~ corruption_perception_index_cpi + ",
        "+ ",
        "  edu_exp_gdp_per_person + ",
        "+ ",
        "  electricity_use_per_person + ",
        "+ ",
        "  gini + ",
        "+ ",
        "  internet_users + ",
        "+ ",
        "  labour_force_participation_rate_percent + ",
        "+ ",
        "  life_expectancy_years +",
        "+ ",
        "  military_spending_pct_of_gdp +",
        "+ ",
        "  murder_per_mil_people, data)",
        "> ",
        "summary(step(object = back, direction = \"forward\"))",
        "Start:  AIC=-808.7\npolrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + \n    electricity_use_per_person + gini + internet_users + labour_force_participation_rate_percent + \n    life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\n\n\nCall:\nlm(formula = polrights_fh ~ corruption_perception_index_cpi + \n    edu_exp_gdp_per_person + electricity_use_per_person + gini + \n    internet_users + labour_force_participation_rate_percent + \n    life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people, \n    data = data)",
        "\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.8490 -0.2113  0.0307  0.3478  1.0485 \n\nCoefficients:\n                                          Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                              6.777e+00  7.740e-01   8.756  < 2e-16 ***\ncorruption_perception_index_cpi          2.262e-02  2.181e-03  10.373  < 2e-16 ***\nedu_exp_gdp_per_person                   1.650e+00  5.932e-01   2.782  0.00557 ** \nelectricity_use_per_person              -4.199e-06  3.821e-06  -1.099  0.27229",
        "    \ngini                                    -4.679e-03  6.175e-03  -0.758  0.44895    \ninternet_users                           1.054e-03  1.407e-03   0.749  0.45404    \nlabour_force_participation_rate_percent  2.484e-01  5.823e-01   0.427  0.66985    \nlife_expectancy_years                   -2.182e-02  9.973e-03  -2.188  0.02906 *  \nmilitary_spending_pct_of_gdp            -1.421e-01  2.205e-02  -6.445 2.29e-10 ***\nmurder_per_mil_people                   -3.356e-02  6.355e-03  -5.281 1.77e-07 ***\n---\nSignif. codes:  ",
        "0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.5317 on 638 degrees of freedom\nMultiple R-squared:  0.5487,\tAdjusted R-squared:  0.5423 \nF-statistic: 86.19 on 9 and 638 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "10",
        "[1] 10\n",
        "> ",
        "subsets %>% filter(df == 10) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% head(1) %>% as.character()",
        "[1] \"character(0)\"\n",
        "> ",
        "subsets %>% filter(df == 9) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% head(1) %>% as.character()",
        "[1] \"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + electricity_use_per_person + gini + internet_users + labour_force_participation_rate_percent + life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\"\n",
        "> ",
        "subsets %>% filter(df == 9) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% head(1) %>% as.character()",
        "[1] \"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + electricity_use_per_person + gini + internet_users + labour_force_participation_rate_percent + life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\"\n",
        "> ",
        "summary(model_df5)",
        "\nCall:\nlm(formula = polrights_fh ~ corruption_perception_index_cpi + \n    edu_exp_gdp_per_person + life_expectancy_years + military_spending_pct_of_gdp + \n    murder_per_mil_people, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.8381 -0.2132  0.0264  0.3555  1.0201 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      6.645643   0.657128  10.113  < 2e-16 ***\ncorruption_perception_index_cpi  0.023329   0.001655  14.096",
        "  < 2e-16 ***\nedu_exp_gdp_per_person           1.900341   0.533705   3.561 0.000397 ***\nlife_expectancy_years           -0.020873   0.008397  -2.486 0.013177 *  \nmilitary_spending_pct_of_gdp    -0.149871   0.018612  -8.052 3.95e-15 ***\nmurder_per_mil_people           -0.034992   0.004280  -8.176 1.57e-15 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.531 on 642 degrees of freedom\nMultiple R-squared:  0.5471,\tAdjusted R-squared:  0.5436 ",
        "\nF-statistic: 155.1 on 5 and 642 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "subsets",
        "\u001B[38;5;246m# A tibble: 511 x 13\u001B[39m\n   model r.squared adj.r.squared sigma statistic   p.value    df  logLik    AIC    BIC\n   \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m         \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m   \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m  \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m  \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m\n\u001B[38;5;250m 1\u001B[39m polr…   0.530         0.529    1.30    \u001B[4m1\u001B[24m159.  9.45\u001B[38;5;246me\u001B[39m\u001B[31m-171\u001B[39m     1  -\u001B[31m\u001B[4m1\u001B[24m73\u001B[39m\u001B[31m1\u001B[39m\u001B[31m.\u001B[39m  \u001B[4m3\u001B[24m469.  \u001B[4m3\u001B[24m483.\n\u001B[38;5;250m 2\u001B[39m polr…   0.114         0.113    1.55     198.  2.04\u001B[38;5;246me\u001B[39m\u001B[31m- 42\u001B[39m     1  -\u001B[31m\u001B[4m2\u001B[24m87\u001B[39m\u001B[31m4\u001B[39m\u001B[31m.\u001B[39m  \u001B[4m5\u001B[24m754.  \u001B[4m5\u001B[24m770.\n\u001B[38;5;250m 3\u001B[39m polr…   0.178         0.178    1.75    \u001B[4m1\u001B[24m113.  3.66\u001B[38;5;246me\u001B[39m\u001B[31m-221\u001B[39m     1 -\u001B[31m\u001B[4m1\u001B[24m\u001B[4m0\u001B[24m1\u001B[39m\u001B[31m91\u001B[39m\u001B[31m.\u001B[39m \u001B[4m2\u001B[24m\u001B[4m0\u001B[24m389. \u001B[4m2\u001B[24m\u001B[4m0\u001B[24m409.\n\u001B[38;5;250m 4\u001B[39m polr…   0.024\u001B[4m4\u001B[24m        0.024\u001B[4m3\u001B[24m   1.92     203.  1.71\u001B[38;5;246me\u001B[39m\u001B[31m- 45\u001B[39m     1 -\u001B[31m\u001B[4m1\u001B[24m\u001B[4m6\u001B[24m7\u001B[39m\u001B[31m79\u001B[39m\u001B[31m.\u001B[39m \u001B[4m3\u001B[24m\u001B[4m3\u001B[24m564. \u001B[4m3\u001B[24m\u001B[4m3\u001B[24m585.\n\u001B[38;5;250m 5\u001B[39m polr…   0.172         0.172    1.68     989.  2.17\u001B[38;5;246me\u001B[39m\u001B[31m-197\u001B[39m     1  -\u001B[31m\u001B[4m9\u001B[24m20\u001B[39m\u001B[31m2\u001B[39m\u001B[31m.\u001B[39m \u001B[4m1\u001B[24m\u001B[4m8\u001B[24m409. \u001B[4m1\u001B[24m\u001B[4m8\u001B[24m428.\n\u001B[38;5;250m 6\u001B[39m polr…   0.009\u001B[4m6\u001B[24m\u001B[4m3\u001B[24m       0.009\u001B[4m4\u001B[24m\u001B[4m4\u001B[24m  1.84      49.3 2.48\u001B[38;5;246me\u001B[39m\u001B[31m- 12\u001B[39m     1 -\u001B[31m\u001B[4m1\u001B[24m\u001B[4m0\u001B[24m2\u001B[39m\u001B[31m78\u001B[39m\u001B[31m.\u001B[39m \u001B[4m2\u001B[24m\u001B[4m0\u001B[24m563. \u001B[4m2\u001B[24m\u001B[4m0\u001B[24m582.\n\u001B[38;5;250m 7\u001B[39m polr…   0.275         0.275    1.64    \u001B[4m2\u001B[24m985.  0.  \u001B[38;5;246m \u001B[39m         1 -\u001B[31m\u001B[4m1\u001B[24m\u001B[4m5\u001B[24m0\u001B[39m\u001B[31m37\u001B[39m\u001B[31m.\u001B[39m \u001B[4m3\u001B[24m\u001B[4m0\u001B[24m080. \u001B[4m3\u001B[24m\u001B[4m0\u001B[24m101.\n\u001B[38;5;250m 8\u001B[39m polr…   0.073\u001B[4m3\u001B[24m        0.073\u001B[4m2\u001B[24m   1.76     474.  3.08\u001B[38;5;246me\u001B[39m\u001B[31m-101\u001B[39m     1 -\u001B[31m\u001B[4m1\u001B[24m\u001B[4m1\u001B[24m8\u001B[39m\u001B[31m90\u001B[39m\u001B[31m.\u001B[39m \u001B[4m2\u001B[24m\u001B[4m3\u001B[24m786. \u001B[4m2\u001B[24m\u001B[4m3\u001B[24m806.\n\u001B[38;5;250m 9\u001B[39m polr…   0.070\u001B[4m5\u001B[24m        0.070\u001B[4m0\u001B[24m   1.55     157.  7.58\u001B[38;5;246me\u001B[39m\u001B[31m- 35\u001B[39m     1  -\u001B[31m\u001B[4m3\u001B[24m85\u001B[39m\u001B[31m1\u001B[39m\u001B[31m.\u001B[39m  \u001B[4m7\u001B[24m709.  \u001B[4m7\u001B[24m726.\n\u001B[38;5;250m10\u001B[39m polr…   0.623         0.622    1.02     374.  1.45\u001B[38;5;246me\u001B[39m\u001B[31m- 96\u001B[39m     2   -\u001B[31m651\u001B[39m\u001B[31m.\u001B[39m  \u001B[4m1\u001B[24m310.  \u001B[4m1\u001B[24m326.\n\u001B[38;5;246m# … with 501 more rows, and 3 more variables: deviance \u001B[3m\u001B[38;5;246m<dbl>\u001B[38;5;246m\u001B[23m, df.residual \u001B[3m\u001B[38;5;246m<int>\u001B[38;5;246m\u001B[23m,\u001B[39m\n\u001B[38;5;246m#   nobs \u001B[3m\u001B[38;5;246m<int>\u001B[38;5;246m\u001B[23m\u001B[39m",
        "\n",
        "> ",
        "subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model)",
        "\u001B[38;5;246m# A tibble: 84 x 1\u001B[39m\n   model                                                                               \n   \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m                                                                               \n\u001B[38;5;250m 1\u001B[39m polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + military_…\n\u001B[38;5;250m 2\u001B[39m polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + labour_fo…\n\u001B[38;5;250m 3\u001B[39m polrights_fh ~ corruption_perception_index_cpi + labour_force_participation_rate_pe…\n\u001B[38;5;250m 4\u001B[39m polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + life_expe…\n\u001B[38;5;250m 5\u001B[39m polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + gini      \n\u001B[38;5;250m 6\u001B[39m polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + internet_…\n\u001B[38;5;250m 7\u001B[39m polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + electrici…\n\u001B[38;5;250m 8\u001B[39m polrights_fh ~ corruption_perception_index_cpi + life_expectancy_years + military_s…\n\u001B[38;5;250m 9\u001B[39m polrights_fh ~ corruption_perception_index_cpi + internet_users + military_spending…\n\u001B[38;5;250m10\u001B[39m polrights_fh ~ corruption_perception_index_cpi + electricity_use_per_person + milit…\n\u001B[38;5;246m# … with 74 more rows\u001B[39m",
        "\n",
        "> ",
        "subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% View()",
        "> ",
        "subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC) %>% View()",
        "> ",
        "subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>% View()",
        "> ",
        "subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared)",
        "\u001B[38;5;246m# A tibble: 84 x 3\u001B[39m\n   model          AIC adj.r.squared\n   \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m        \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m         \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m\n\u001B[38;5;250m 1\u001B[39m polrights_f… \u001B[4m1\u001B[24m148.         0.677\n\u001B[38;5;250m 2\u001B[39m polrights_f… \u001B[4m1\u001B[24m291.         0.629\n\u001B[38;5;250m 3\u001B[39m polrights_f… \u001B[4m2\u001B[24m653.         0.627\n\u001B[38;5;250m 4\u001B[39m polrights_f… \u001B[4m1\u001B[24m307.         0.625\n\u001B[38;5;250m 5\u001B[39m polrights_f… \u001B[4m1\u001B[24m311.         0.622\n\u001B[38;5;250m 6\u001B[39m polrights_f… \u001B[4m1\u001B[24m311.         0.621\n\u001B[38;5;250m 7\u001B[39m polrights_f…  586.         0.621\n\u001B[38;5;250m 8\u001B[39m polrights_f… \u001B[4m2\u001B[24m679.         0.620\n\u001B[38;5;250m 9\u001B[39m polrights_f… \u001B[4m2\u001B[24m686.         0.616\n\u001B[38;5;250m10\u001B[39m polrights_f… \u001B[4m1\u001B[24m158.         0.612\n\u001B[38;5;246m# … with 74 more rows\u001B[39m",
        "\n",
        "> ",
        "subsets %>% filter(df == 4) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>% View()",
        "> ",
        "subsets %>% filter(df == 4) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% as.character()",
        "[1] \"c(\\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + life_expectancy_years + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + labour_force_participation_rate_percent + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + internet_users + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + gini + military_spending_pct_of_gdp\\\", \\n\\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + electricity_use_per_person + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + gini + labour_force_participation_rate_percent\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + labour_force_participation_rate_percent + life_expectancy_years + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + labour_force_participation_rate_percent + life_expectancy_years\\\", \\n\\\"polrights_fh ~ corruption_perception_index_cpi + electricity_use_per_person + internet_users + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + gini + labour_force_participation_rate_percent + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + internet_users + labour_force_participation_rate_percent + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + internet_users + labour_force_participation_rate_percent\\\", \\n\\\"polrights_fh ~ corruption_perception_index_cpi + electricity_use_per_person + labour_force_participation_rate_percent + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + electricity_use_per_person + labour_force_participation_rate_percent\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + gini + life_expectancy_years\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + internet_users + life_expectancy_years\\\", \\n\\\"polrights_fh ~ corruption_perception_index_cpi + electricity_use_per_person + life_expectancy_years + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + electricity_use_per_person + life_expectancy_years\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + electricity_use_per_person + internet_users\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + gini + internet_users\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + gini + life_expectancy_years + military_spending_pct_of_gdp\\\", \\n\\\"polrights_fh ~ corruption_perception_index_cpi + internet_users + life_expectancy_years + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + electricity_use_per_person + gini\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + gini + internet_users + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + electricity_use_per_person + gini + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + labour_force_participation_rate_percent + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\n\\\"polrights_fh ~ corruption_perception_index_cpi + gini + labour_force_participation_rate_percent + life_expectancy_years\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + gini + labour_force_participation_rate_percent + murder_per_mil_people\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + gini + internet_users + labour_force_participation_rate_percent\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + internet_users + labour_force_participation_rate_percent + life_expectancy_years\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + electricity_use_per_person + gini + labour_force_participation_rate_percent\\\", \\n\\\"polrights_fh ~ corruption_perception_index_cpi + internet_users + labour_force_participation_rate_percent + murder_per_mil_people\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + gini + internet_users + life_expectancy_years\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + electricity_use_per_person + labour_force_participation_rate_percent + life_expectancy_years\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + electricity_use_per_person + gini + life_expectancy_years\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + internet_users + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\n\\\"polrights_fh ~ corruption_perception_index_cpi + electricity_use_per_person + internet_users + labour_force_participation_rate_percent\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + electricity_use_per_person + gini + internet_users\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + electricity_use_per_person + internet_users + life_expectancy_years\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + gini + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + labour_force_participation_rate_percent + life_expectancy_years + murder_per_mil_people\\\", \\n\\\"polrights_fh ~ corruption_perception_index_cpi + life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + electricity_use_per_person + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + internet_users + life_expectancy_years + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\n\\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + gini + murder_per_mil_people\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + electricity_use_per_person + labour_force_participation_rate_percent + murder_per_mil_people\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + electricity_use_per_person + gini + murder_per_mil_people\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + gini + life_expectancy_years + murder_per_mil_people\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + labour_force_participation_rate_percent + murder_per_mil_people\\\", \\n\\\"polrights_fh ~ corruption_perception_index_cpi + gini + internet_users + murder_per_mil_people\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + gini + life_expectancy_years + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + electricity_use_per_person + internet_users + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + labour_force_participation_rate_percent + life_expectancy_years + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + internet_users + labour_force_participation_rate_percent + military_spending_pct_of_gdp\\\", \\n\\\"polrights_fh ~ labour_force_participation_rate_percent + life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + gini + internet_users + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + electricity_use_per_person + life_expectancy_years + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + life_expectancy_years + murder_per_mil_people\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + internet_users + murder_per_mil_people\\\", \\n\\\"polrights_fh ~ edu_exp_gdp_per_person + electricity_use_per_person + labour_force_participation_rate_percent + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + internet_users + life_expectancy_years + murder_per_mil_people\\\", \\\"polrights_fh ~ internet_users + life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + electricity_use_per_person + gini + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + electricity_use_per_person + murder_per_mil_people\\\", \\n\\\"polrights_fh ~ gini + labour_force_participation_rate_percent + life_expectancy_years + murder_per_mil_people\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + electricity_use_per_person + internet_users + murder_per_mil_people\\\", \\\"polrights_fh ~ electricity_use_per_person + labour_force_participation_rate_percent + life_expectancy_years + murder_per_mil_people\\\", \\\"polrights_fh ~ electricity_use_per_person + gini + life_expectancy_years + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ gini + internet_users + life_expectancy_years + murder_per_mil_people\\\", \\n\\\"polrights_fh ~ edu_exp_gdp_per_person + internet_users + labour_force_participation_rate_percent + life_expectancy_years\\\", \\\"polrights_fh ~ electricity_use_per_person + internet_users + life_expectancy_years + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + gini + internet_users + life_expectancy_years\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + electricity_use_per_person + internet_users + life_expectancy_years\\\", \\\"polrights_fh ~ corruption_perception_index_cpi + electricity_use_per_person + life_expectancy_years + murder_per_mil_people\\\", \\n\\\"polrights_fh ~ edu_exp_gdp_per_person + electricity_use_per_person + gini + internet_users\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + electricity_use_per_person + internet_users + labour_force_participation_rate_percent\\\", \\\"polrights_fh ~ gini + internet_users + life_expectancy_years + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ electricity_use_per_person + life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\\"polrights_fh ~ gini + life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\n\\\"polrights_fh ~ edu_exp_gdp_per_person + gini + internet_users + labour_force_participation_rate_percent\\\", \\\"polrights_fh ~ internet_users + labour_force_participation_rate_percent + life_expectancy_years + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ electricity_use_per_person + internet_users + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\\"polrights_fh ~ electricity_use_per_person + labour_force_participation_rate_percent + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\n\\\"polrights_fh ~ edu_exp_gdp_per_person + gini + labour_force_participation_rate_percent + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ electricity_use_per_person + gini + internet_users + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ electricity_use_per_person + internet_users + life_expectancy_years + murder_per_mil_people\\\", \\\"polrights_fh ~ electricity_use_per_person + labour_force_participation_rate_percent + life_expectancy_years + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ electricity_use_per_person + internet_users + labour_force_participation_rate_percent + military_spending_pct_of_gdp\\\", \\n\\\"polrights_fh ~ gini + internet_users + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\\"polrights_fh ~ internet_users + labour_force_participation_rate_percent + life_expectancy_years + murder_per_mil_people\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + gini + labour_force_participation_rate_percent + life_expectancy_years\\\", \\\"polrights_fh ~ electricity_use_per_person + gini + internet_users + murder_per_mil_people\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + gini + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\n\\\"polrights_fh ~ gini + labour_force_participation_rate_percent + life_expectancy_years + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + gini + internet_users + murder_per_mil_people\\\", \\\"polrights_fh ~ electricity_use_per_person + gini + life_expectancy_years + murder_per_mil_people\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + gini + life_expectancy_years + murder_per_mil_people\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + internet_users + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\n\\\"polrights_fh ~ internet_users + labour_force_participation_rate_percent + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\\"polrights_fh ~ gini + internet_users + labour_force_participation_rate_percent + murder_per_mil_people\\\", \\\"polrights_fh ~ electricity_use_per_person + gini + internet_users + life_expectancy_years\\\", \\\"polrights_fh ~ electricity_use_per_person + internet_users + labour_force_participation_rate_percent + murder_per_mil_people\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + electricity_use_per_person + gini + life_expectancy_years\\\", \\n\\\"polrights_fh ~ electricity_use_per_person + internet_users + labour_force_participation_rate_percent + life_expectancy_years\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + electricity_use_per_person + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\\"polrights_fh ~ gini + internet_users + labour_force_participation_rate_percent + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ electricity_use_per_person + gini + labour_force_participation_rate_percent + murder_per_mil_people\\\", \\\"polrights_fh ~ electricity_use_per_person + gini + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\n\\\"polrights_fh ~ edu_exp_gdp_per_person + electricity_use_per_person + labour_force_participation_rate_percent + life_expectancy_years\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + labour_force_participation_rate_percent + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\\"polrights_fh ~ gini + internet_users + labour_force_participation_rate_percent + life_expectancy_years\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + electricity_use_per_person + gini + murder_per_mil_people\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + gini + labour_force_participation_rate_percent + murder_per_mil_people\\\", \\n\\\"polrights_fh ~ electricity_use_per_person + gini + labour_force_participation_rate_percent + life_expectancy_years\\\", \\\"polrights_fh ~ gini + labour_force_participation_rate_percent + military_spending_pct_of_gdp + murder_per_mil_people\\\", \\\"polrights_fh ~ electricity_use_per_person + gini + labour_force_participation_rate_percent + military_spending_pct_of_gdp\\\", \\\"polrights_fh ~ electricity_use_per_person + gini + internet_users + labour_force_participation_rate_percent\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + electricity_use_per_person + gini + labour_force_participation_rate_percent\\\", \\n\\\"polrights_fh ~ edu_exp_gdp_per_person + internet_users + life_expectancy_years + murder_per_mil_people\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + electricity_use_per_person + internet_users + murder_per_mil_people\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + internet_users + labour_force_participation_rate_percent + murder_per_mil_people\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + labour_force_participation_rate_percent + life_expectancy_years + murder_per_mil_people\\\", \\\"polrights_fh ~ edu_exp_gdp_per_person + electricity_use_per_person + life_expectancy_years + murder_per_mil_people\\\", \\n\\\"polrights_fh ~ edu_exp_gdp_per_person + electricity_use_per_person + labour_force_participation_rate_percent + murder_per_mil_people\\\")\"",
        "\n",
        "> ",
        "subsets %>% filter(df == 4) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model)",
        "\u001B[38;5;246m# A tibble: 126 x 1\u001B[39m\n   model                           \n   \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m                           \n\u001B[38;5;250m 1\u001B[39m polrights_fh ~ corruption_perce…\n\u001B[38;5;250m 2\u001B[39m polrights_fh ~ corruption_perce…\n\u001B[38;5;250m 3\u001B[39m polrights_fh ~ corruption_perce…\n\u001B[38;5;250m 4\u001B[39m polrights_fh ~ corruption_perce…\n\u001B[38;5;250m 5\u001B[39m polrights_fh ~ corruption_perce…\n\u001B[38;5;250m 6\u001B[39m polrights_fh ~ corruption_perce…\n\u001B[38;5;250m 7\u001B[39m polrights_fh ~ corruption_perce…\n\u001B[38;5;250m 8\u001B[39m polrights_fh ~ corruption_perce…\n\u001B[38;5;250m 9\u001B[39m polrights_fh ~ corruption_perce…\n\u001B[38;5;250m10\u001B[39m polrights_fh ~ corruption_perce…\n\u001B[38;5;246m# … with 116 more rows\u001B[39m",
        "\n",
        "> ",
        "subsets %>% filter(df == 4) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% head(1) %>% as.character() %>% ",
        "+ ",
        "subsets %>% filter(df == 4) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% head(1) %>% as.character() ",
        "Error in subsets(.) : could not find function \"subsets\"\n",
        "> ",
        "subsets %>% filter(df == 4) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% head(1) %>% as.character() ",
        "[1] \"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + life_expectancy_years + military_spending_pct_of_gdp\"\n",
        "> ",
        "subsets %>% filter(df == 4) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>%",
        "+ ",
        "  select(model) %>% head(1) %>% as.character() ",
        "[1] \"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + life_expectancy_years + military_spending_pct_of_gdp\"\n",
        "> ",
        "subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>%",
        "+ ",
        "  select(model) %>% View()",
        "> ",
        "subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>%",
        "+ ",
        "  select(model) %>% View()",
        "> ",
        "subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>%",
        "+ ",
        "  select(model) %>% head(1) %>% as.character() ",
        "[1] \"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + military_spending_pct_of_gdp\"\n",
        "> ",
        "subsets %>% filter(df == 4) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>%",
        "+ ",
        "  select(model) %>% View()",
        "> ",
        "subsets %>% filter(df == 4) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>% View()",
        "> ",
        "subsets %>% filter(df == 4) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  View()",
        "> ",
        "subsets %>% filter(df == 4) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% head(1) %>% as.character() ",
        "[1] \"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + life_expectancy_years + military_spending_pct_of_gdp\"\n",
        "> ",
        "model_df4_formula <- subsets %>% filter(df == 4) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% head(1) %>% as.character() ",
        "> ",
        "lm(model_df4_formula, data)",
        "\nCall:\nlm(formula = model_df4_formula, data = data)\n\nCoefficients:\n                    (Intercept)  \n                       4.683192  \ncorruption_perception_index_cpi  \n                       0.028787  \n         edu_exp_gdp_per_person  \n                       3.107232  \n          life_expectancy_years  \n                      -0.005252  \n   military_spending_pct_of_gdp  \n                      -0.149918  \n\n",
        "> ",
        "lm(model_df4_formula, data)",
        "\nCall:\nlm(formula = model_df4_formula, data = data)\n\nCoefficients:\n                    (Intercept)  corruption_perception_index_cpi  \n                       4.683192                         0.028787  \n         edu_exp_gdp_per_person            life_expectancy_years  \n                       3.107232                        -0.005252  \n   military_spending_pct_of_gdp  \n                      -0.149918  \n\n",
        "> ",
        "summary(fit_df4)",
        "Error in summary(fit_df4) : object 'fit_df4' not found\n",
        "> ",
        "fit_df4 <- lm(model_df4_formula, data)",
        "> ",
        "summary(fit_df4)",
        "\nCall:\nlm(formula = model_df4_formula, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.5580 -0.2961  0.0301  0.3913  1.1214 \n\nCoefficients:\n                                 Estimate Std. Error t value\n(Intercept)                      4.683192   0.642274   7.292\ncorruption_perception_index_cpi  0.028787   0.001590  18.106\nedu_exp_gdp_per_person           3.107232   0.538502   5.770\nlife_expectancy_years           -0.005252   0.008585  -0.612\nmilitary_spending_pct_of_gdp    -0.149918   0.019542",
        "  -7.672\n                                Pr(>|t|)    \n(Intercept)                     9.03e-13 ***\ncorruption_perception_index_cpi  < 2e-16 ***\nedu_exp_gdp_per_person          1.23e-08 ***\nlife_expectancy_years              0.541    \nmilitary_spending_pct_of_gdp    6.31e-14 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.5575 on 643 degrees of freedom\nMultiple R-squared:    0.5,\tAdjusted R-squared:  0.4968 \nF-statistic: 160.7 on 4 and 643",
        " DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "fit_df4 <- lm(model_df4_formula, data)",
        "> ",
        "summary(fit_df4)",
        "\nCall:\nlm(formula = model_df4_formula, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.5580 -0.2961  0.0301  0.3913  1.1214 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      4.683192   0.642274   7.292 9.03e-13 ***\ncorruption_perception_index_cpi  0.028787   0.001590  18.106  < 2e-16 ***\nedu_exp_gdp_per_person           3.107232   0.538502   5.770 1.23e-08 ***\nlife_expectancy_years           -0.005252   0.008585  -0.612",
        "    0.541    \nmilitary_spending_pct_of_gdp    -0.149918   0.019542  -7.672 6.31e-14 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.5575 on 643 degrees of freedom\nMultiple R-squared:    0.5,\tAdjusted R-squared:  0.4968 \nF-statistic: 160.7 on 4 and 643 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "subsets %>% filter(df == 4) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  View()",
        "> ",
        "model_df4_formula <- subsets %>% filter(df == 4) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% head(1) %>% as.character() ",
        "> ",
        "fit_df4 <- lm(model_df4_formula, data)",
        "> ",
        "summary(fit_df4)",
        "\nCall:\nlm(formula = model_df4_formula, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.5580 -0.2961  0.0301  0.3913  1.1214 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      4.683192   0.642274   7.292 9.03e-13 ***\ncorruption_perception_index_cpi  0.028787   0.001590  18.106  < 2e-16 ***\nedu_exp_gdp_per_person           3.107232   0.538502   5.770 1.23e-08 ***\nlife_expectancy_years           -0.005252   0.008585  -0.612",
        "    0.541    \nmilitary_spending_pct_of_gdp    -0.149918   0.019542  -7.672 6.31e-14 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.5575 on 643 degrees of freedom\nMultiple R-squared:    0.5,\tAdjusted R-squared:  0.4968 \nF-statistic: 160.7 on 4 and 643 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>%",
        "+ ",
        "  select(model) %>% View()",
        "> ",
        "subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>%",
        "+ ",
        "  select(model) %>% head(1) %>% as.character() ",
        "[1] \"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + military_spending_pct_of_gdp\"\n",
        "> ",
        "subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>%",
        "+ ",
        "  select(model) %>% head(1) %>% as.character()",
        "[1] \"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + military_spending_pct_of_gdp\"\n",
        "> ",
        "subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>%",
        "+ ",
        "  select(model) %>% View()",
        "> ",
        "model_df3_formula <- subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>%",
        "+ ",
        "  select(model) %>% head(1) %>% as.character() ",
        "> ",
        "fit_df3 <- lm(model_df3_formula, data)",
        "> ",
        "summary(fit_df3)",
        "\nCall:\nlm(formula = model_df3_formula, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.5684 -0.3018  0.0245  0.4021  1.1105 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      4.300518   0.145524  29.552  < 2e-16 ***\ncorruption_perception_index_cpi  0.028379   0.001442  19.678  < 2e-16 ***\nedu_exp_gdp_per_person           3.084391   0.536945   5.744 1.42e-08 ***\nmilitary_spending_pct_of_gdp    -0.150747   0.019485  -7.736",
        " 3.96e-14 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.5572 on 644 degrees of freedom\nMultiple R-squared:  0.4997,\tAdjusted R-squared:  0.4973 \nF-statistic: 214.4 on 3 and 644 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "summary(fit_df4)",
        "\nCall:\nlm(formula = model_df4_formula, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.5580 -0.2961  0.0301  0.3913  1.1214 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      4.683192   0.642274   7.292 9.03e-13 ***\ncorruption_perception_index_cpi  0.028787   0.001590  18.106  < 2e-16 ***\nedu_exp_gdp_per_person           3.107232   0.538502   5.770 1.23e-08 ***\nlife_expectancy_years           -0.005252   0.008585  -0.612",
        "    0.541    \nmilitary_spending_pct_of_gdp    -0.149918   0.019542  -7.672 6.31e-14 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.5575 on 643 degrees of freedom\nMultiple R-squared:    0.5,\tAdjusted R-squared:  0.4968 \nF-statistic: 160.7 on 4 and 643 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "model_df3_formula <- subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>%",
        "+ ",
        "  select(model) %>% head(1) %>% as.character() ",
        "> ",
        "fit_df3 <- lm(model_df3_formula, data)",
        "> ",
        "summary(fit_df3)",
        "\nCall:\nlm(formula = model_df3_formula, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.5684 -0.3018  0.0245  0.4021  1.1105 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      4.300518   0.145524  29.552  < 2e-16 ***\ncorruption_perception_index_cpi  0.028379   0.001442  19.678  < 2e-16 ***\nedu_exp_gdp_per_person           3.084391   0.536945   5.744 1.42e-08 ***\nmilitary_spending_pct_of_gdp    -0.150747   0.019485  -7.736",
        " 3.96e-14 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.5572 on 644 degrees of freedom\nMultiple R-squared:  0.4997,\tAdjusted R-squared:  0.4973 \nF-statistic: 214.4 on 3 and 644 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "summary(fit_df4)",
        "\nCall:\nlm(formula = model_df4_formula, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.5580 -0.2961  0.0301  0.3913  1.1214 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      4.683192   0.642274   7.292 9.03e-13 ***\ncorruption_perception_index_cpi  0.028787   0.001590  18.106  < 2e-16 ***\nedu_exp_gdp_per_person           3.107232   0.538502   5.770 1.23e-08 ***\nlife_expectancy_years           -0.005252   0.008585  -0.612",
        "    0.541    \nmilitary_spending_pct_of_gdp    -0.149918   0.019542  -7.672 6.31e-14 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.5575 on 643 degrees of freedom\nMultiple R-squared:    0.5,\tAdjusted R-squared:  0.4968 \nF-statistic: 160.7 on 4 and 643 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "summary(fit_df3)",
        "\nCall:\nlm(formula = model_df3_formula, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.5684 -0.3018  0.0245  0.4021  1.1105 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      4.300518   0.145524  29.552  < 2e-16 ***\ncorruption_perception_index_cpi  0.028379   0.001442  19.678  < 2e-16 ***\nedu_exp_gdp_per_person           3.084391   0.536945   5.744 1.42e-08 ***\nmilitary_spending_pct_of_gdp    -0.150747   0.019485  -7.736",
        " 3.96e-14 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.5572 on 644 degrees of freedom\nMultiple R-squared:  0.4997,\tAdjusted R-squared:  0.4973 \nF-statistic: 214.4 on 3 and 644 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "model_df3_formula <- subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>%",
        "+ ",
        "  select(model) %>% head(1) %>% as.character() ",
        "> ",
        "fit_df3 <- lm(model_df3_formula, data)",
        "> ",
        "summary(fit_df3)",
        "\nCall:\nlm(formula = model_df3_formula, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.5684 -0.3018  0.0245  0.4021  1.1105 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      4.300518   0.145524  29.552  < 2e-16 ***\ncorruption_perception_index_cpi  0.028379   0.001442  19.678  < 2e-16 ***\nedu_exp_gdp_per_person           3.084391   0.536945   5.744 1.42e-08 ***\nmilitary_spending_pct_of_gdp    -0.150747   0.019485  -7.736",
        " 3.96e-14 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.5572 on 644 degrees of freedom\nMultiple R-squared:  0.4997,\tAdjusted R-squared:  0.4973 \nF-statistic: 214.4 on 3 and 644 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "model_df3_formula",
        "[1] \"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + military_spending_pct_of_gdp\"\n",
        "> ",
        "subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>%",
        "+ ",
        "  select(model) %>% head(1) %>% as.formula()",
        "~model\n<environment: 0x7fd910739538>\n",
        "> ",
        "subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>%",
        "+ ",
        "  select(model) %>% head(1) %>% as.character() ",
        "[1] \"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + military_spending_pct_of_gdp\"\n",
        "> ",
        "summary(fit_df3)",
        "\nCall:\nlm(formula = model_df3_formula, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.5684 -0.3018  0.0245  0.4021  1.1105 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      4.300518   0.145524  29.552  < 2e-16 ***\ncorruption_perception_index_cpi  0.028379   0.001442  19.678  < 2e-16 ***\nedu_exp_gdp_per_person           3.084391   0.536945   5.744 1.42e-08 ***\nmilitary_spending_pct_of_gdp    -0.150747   0.019485  -7.736",
        " 3.96e-14 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.5572 on 644 degrees of freedom\nMultiple R-squared:  0.4997,\tAdjusted R-squared:  0.4973 \nF-statistic: 214.4 on 3 and 644 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>%",
        "+ ",
        "  select(model) %>% head(1) %>% as.character() ",
        "[1] \"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + military_spending_pct_of_gdp\"\n",
        "> ",
        "subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% View()",
        "> ",
        "model_df3_formula <- subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>%",
        "+ ",
        "  select(model) %>% head(1) %>% as.character() ",
        "> ",
        "fit_df3 <- lm(model_df3_formula, data)",
        "> ",
        "summary(fit_df3)",
        "\nCall:\nlm(formula = model_df3_formula, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.5684 -0.3018  0.0245  0.4021  1.1105 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      4.300518   0.145524  29.552  < 2e-16 ***\ncorruption_perception_index_cpi  0.028379   0.001442  19.678  < 2e-16 ***\nedu_exp_gdp_per_person           3.084391   0.536945   5.744 1.42e-08 ***\nmilitary_spending_pct_of_gdp    -0.150747   0.019485  -7.736",
        " 3.96e-14 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.5572 on 644 degrees of freedom\nMultiple R-squared:  0.4997,\tAdjusted R-squared:  0.4973 \nF-statistic: 214.4 on 3 and 644 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "View(data)",
        "> ",
        "data <- data %>%",
        "+ ",
        "  filter(year > 2000, year < 2019, country %in% countries) %>% ",
        "+ ",
        "  group_by(country) %>%",
        "+ ",
        "  mutate_at(vars(-country),list(~ifelse(is.na(.), median(., na.rm = TRUE), .))) %>% ",
        "+ ",
        "# Iceland spent 0 so I needed to manually recode that",
        "+ ",
        "  mutate(military_spending_pct_of_gdp = replace_na(military_spending_pct_of_gdp, 0)) %>% ",
        "+ ",
        "  mutate(murder_per_mil_people = replace(murder_per_mil_people, country == \"Mexico\", 29.07),",
        "+ ",
        "         # https://en.wikipedia.org/wiki/List_of_countries_by_intentional_homicide_rate",
        "+ ",
        "         # these murder rates were not included in the gapminder but i didnt want to ",
        "+ ",
        "         # lose 3 important countries in LA",
        "+ ",
        "         murder_per_mil_people = replace(murder_per_mil_people, country == \"Chile\", 4.4),",
        "+ ",
        "         murder_per_mil_people = replace(murder_per_mil_people, country == \"Colombia\", 25.34)) %>% ",
        "+ ",
        "  relocate(polrights_fh) %>% mutate(polrights_fh = (8 - polrights_fh),",
        "+ ",
        "                                    military_spending_pct_of_gdp = military_spending_pct_of_gdp * 100,",
        "+ ",
        "                                    corruption_perception_index_cpi = 100 - corruption_perception_index_cpi )",
        "> ",
        "write_csv(data, here::here(\"data\", \"df.csv\"))",
        "> ",
        "data <- readr::read_csv(here::here(\"data\", \"df.csv\"))",
        "\n\u001B[36m──\u001B[39m \u001B[1m\u001B[1mColumn specification\u001B[1m\u001B[22m \u001B[36m────────────────────────────────────────────────────────\u001B[39m\ncols(\n  polrights_fh = \u001B[32mcol_double()\u001B[39m,\n  country = \u001B[31mcol_character()\u001B[39m,\n  year = \u001B[32mcol_double()\u001B[39m,\n  corruption_perception_index_cpi = \u001B[32mcol_double()\u001B[39m,\n  edu_exp_gdp_per_person = \u001B[32mcol_double()\u001B[39m,\n  electricity_use_per_person = \u001B[32mcol_double()\u001B[39m,\n  gini = \u001B[32mcol_double()\u001B[39m,\n  internet_users = \u001B[32mcol_double()\u001B[39m,\n  labour_force_participation_rate_percent = \u001B[32mcol_double()\u001B[39m,\n  life_expectancy_years = \u001B[32mcol_double()\u001B[39m,\n  military_spending_pct_of_gdp = \u001B[32mcol_double()\u001B[39m,\n  murder_per_mil_people = \u001B[32mcol_double()\u001B[39m\n)\n\n",
        "> ",
        "model_df5_formula <- subsets %>% filter(df == 5) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% head(1) %>% as.character()",
        "> ",
        "model_df5 <- lm(polrights_fh ~ corruption_perception_index_cpi + ",
        "+ ",
        "            edu_exp_gdp_per_person + ",
        "+ ",
        "            life_expectancy_years + ",
        "+ ",
        "            military_spending_pct_of_gdp + ",
        "+ ",
        "            murder_per_mil_people, data)",
        "> ",
        "subsets %>% filter(df == 9) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model) %>% head(1) %>% as.character()",
        "[1] \"polrights_fh ~ corruption_perception_index_cpi + edu_exp_gdp_per_person + electricity_use_per_person + gini + internet_users + labour_force_participation_rate_percent + life_expectancy_years + military_spending_pct_of_gdp + murder_per_mil_people\"\n",
        "> ",
        "summary(model_df5)",
        "\nCall:\nlm(formula = polrights_fh ~ corruption_perception_index_cpi + \n    edu_exp_gdp_per_person + life_expectancy_years + military_spending_pct_of_gdp + \n    murder_per_mil_people, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.0201 -0.3555 -0.0264  0.2132  3.8381 \n\nCoefficients:\n                                  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                     -0.9785120  0.6924451  -1.413 0.158103    \ncorruption_perception_index_cpi  0.0233287  0.0016550  14.096",
        "  < 2e-16 ***\nedu_exp_gdp_per_person          -1.9003406  0.5337050  -3.561 0.000397 ***\nlife_expectancy_years            0.0208733  0.0083968   2.486 0.013177 *  \nmilitary_spending_pct_of_gdp     0.0014987  0.0001861   8.052 3.95e-15 ***\nmurder_per_mil_people            0.0349922  0.0042801   8.176 1.57e-15 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.531 on 642 degrees of freedom\nMultiple R-squared:  0.5471,\tAdjusted R-squared:  0.5436",
        " \nF-statistic: 155.1 on 5 and 642 DF,  p-value: < 2.2e-16\n\n",
        "> ",
        "subsets %>% filter(df == 4) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  View()",
        "> ",
        "model_df3_formula <- subsets %>% filter(df == 3) %>% ",
        "+ ",
        "  arrange(desc(adj.r.squared)) %>% ",
        "+ ",
        "  select(model, AIC, adj.r.squared) %>%",
        "+ ",
        "  select(model) %>% head(1) %>% as.character() ",
        "> ",
        "fit_df3 <- lm(model_df3_formula, data)",
        "> ",
        "summary(fit_df3)",
        "\nCall:\nlm(formula = model_df3_formula, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.1105 -0.4021 -0.0245  0.3018  3.5684 \n\nCoefficients:\n                                  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                      0.8616003  0.1269702   6.786 2.62e-11 ***\ncorruption_perception_index_cpi  0.0283788  0.0014422  19.678  < 2e-16 ***\nedu_exp_gdp_per_person          -3.0843912  0.5369453  -5.744 1.42e-08 ***\nmilitary_spending_pct_of_gdp     0.0015075  0.0001949",
        "   7.736 3.96e-14 ***\n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 0.5572 on 644 degrees of freedom\nMultiple R-squared:  0.4997,\tAdjusted R-squared:  0.4973 \nF-statistic: 214.4 on 3 and 644 DF,  p-value: < 2.2e-16\n\n\nRestarting R session...\n\n"
    ]
}