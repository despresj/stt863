"0","library(dplyr)"
"0","df <- df %>% "
"0","  mutate(predict = predict(fit),"
"0","               e = resid(fit)) %>% "
"0","  arrange(predict)"
"0","lower <- df %>% filter(predict < quantile(predict, .5)) %>% arrange(predict)"
"0","upper <- df %>% filter(predict >= quantile(predict, .5)) %>% arrange(desc(predict))"
"0",""
"0","d1 <- mean(abs(lower$e - median(lower$e)))"
"0","d2 <- mean(abs(upper$e - median(upper$e)))"
"0",""
"0","s <- sum((abs(lower$e - median(lower$e)) - d1)^2) +"
"0","     sum((abs(upper$e - median(upper$e)) - d2)^2)"
"0","sq <- s / (nrow(df) - 2)"
"0","s <- sqrt(sq)"
"0","sq <- sqrt((1/40) + (1/41))"
"0","tstar <- (d1 - d2) / (s*sq)"
"0","qt(p = .975, 79)"
"1","[1]"
"1"," 1.99045"
"1","
"
"0","c(d1, d2, s, tstar)"
"1","[1]"
"1"," 1.0598718"
"1"," 0.8758039"
"1"," 0.9699731"
"1"," 0.8538817"
"1","
"
