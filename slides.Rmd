---
title: "Measuring Political Freedom Around the World"
subtitle: "Sabrina Ball, Joe Despres, Joe Sigler, Jacob Haywood"
date: "Last compiled `r format(Sys.time(), '%H:%M')`"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
source(here::here("R", "regression.R"))
library(kableExtra)
options(htmltools.dir.version = FALSE, echo = FALSE)
knitr::opts_chunk$set(echo = FALSE)
```

# Outline

* What factors are associated with an increase in political freedom?

--

* study political freedom as a function of social, economic, political factors

--

* From Data provided by the Gapminder Foundation.

---
class: inverse, middle, center

# Data

---


# Data

* filtered to only include OECD Countries from year 2000 to 2018

---

# Define political freedom

--

* Freedomhouse index

--

* summarsze fh index


---
# Best Subsets
```{r message=FALSE}
subsets %>% 
  group_by(df) %>% 
  filter(adj.r.squared == max(adj.r.squared)) %>% 
  mutate_if(is.numeric, round, 3) %>% 
  rename(a_rsq = adj.r.squared) %>% 
  select(df, a_rsq, model) %>% 
  arrange(desc(a_rsq)) %>% 
DT::datatable(fillContainer = FALSE, options = list(pageLength = 3))
```
---

class: center
### Best Subsets
```{r, message=FALSE, warning=FALSE, fig.align='center', fig.width=12, fig.height=8}
r <- subsets %>% group_by(df) %>% summarise(adj = max(adj.r.squared, na.rm = T))

subsets %>% 
  ggplot(aes(x = df, y = adj.r.squared)) + 
  geom_point() + 
  geom_smooth(data = r, aes(df, adj), se = FALSE, span = 0.5, color = "Green") + 
  labs(title = "", x = "Parameters", y = "Adjusted R Squared") + 
  scale_x_continuous(breaks = 1:9) + 
  theme_light(base_size = 30)


```

---

class: inverse, middle, center

# Model
---

class: center, middle

```{r include=FALSE}
equatiomatic::extract_eq(model = model_df5, intercept = "beta", terms_per_line = 1)
```

$$
\large
\begin{align}
\operatorname{polrights} = \beta_{0} + \beta_{1}(\operatorname{corruption\_perception\_index\_cpi}) +\\ \beta_{2}(\operatorname{edu\_exp\_gdp\_per\_person}) +\\ \beta_{3}(\operatorname{life\_expectancy\_years}) +\\ \beta_{4}(\operatorname{military\_spending\_pct\_of\_gdp}) +\\ \beta_{5}(\operatorname{murder\_per\_mil\_people}) + \epsilon
\end{align}
$$


---
class: center

$$
\tiny
\begin{align}
\operatorname{polrights} = \beta_{0} + \beta_{1}(\operatorname{corruption\_perception\_index\_cpi}) +\\ \beta_{2}(\operatorname{edu\_exp\_gdp\_per\_person}) +\\ \beta_{3}(\operatorname{life\_expectancy\_years}) +\\ \beta_{4}(\operatorname{military\_spending\_pct\_of\_gdp}) +\\ \beta_{5}(\operatorname{murder\_per\_mil\_people}) + \epsilon
\end{align}
$$

```{r}
broom::tidy(model_df5) %>% 
  kable()
```
---
class: animated, fadeIn, center
$$
\tiny
\begin{align}
\operatorname{polrights} = \beta_{0} + \beta_{1}(\operatorname{corruption\_perception\_index\_cpi}) +\\ \beta_{2}(\operatorname{edu\_exp\_gdp\_per\_person}) +\\ \beta_{3}(\operatorname{life\_expectancy\_years}) +\\ \beta_{4}(\operatorname{military\_spending\_pct\_of\_gdp}) +\\ \beta_{5}(\operatorname{murder\_per\_mil\_people}) + \epsilon
\end{align}
$$
```{r}
broom::tidy(model_df5) %>% 
  kable() %>% 
  row_spec(4, bold = T, color = "white", background = "#D7261E")
```

---

class: center, top
<font size="1">
```{r results='asis',out.width='25%', fig.align='center'}
stargazer::stargazer(fit_df6, model_df5, fit_df4, type = "html", 
                     title = "Regression Results", 
                     covariate.labels = c(),header = FALSE,
single.row=FALSE,column.sep.width = "-15pt", column.separate = 1)
```


---
class: center, middle

# Thanks You and We are Happy to Take Questions

Slides created via the R package [**xaringan**](https://github.com/yihui/xaringan).
